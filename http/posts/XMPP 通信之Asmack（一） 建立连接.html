<p>&#xA0; &#x5148;&#x58F0;&#x660E;&#xFF1A;&#x6211;&#x8FD9;&#x91CC;&#x4E0D;&#x5206;&#x6790;&#x6E90;&#x7801;&#xFF0C;&#x53EA;&#x4ECB;&#x7ECD;&#x5F00;&#x53D1;&#x5305;&#x7684;&#x4F7F;&#x7528;,&#x6B22;&#x8FCE;&#x5927;&#x5BB6;&#x4EA4;&#x6D41;</p>
<p>&#xA0; openfire+spark+smack&#x662F;java&#x9886;&#x57DF;&#x7684;&#x4E00;&#x79CD;&#x5373;&#x65F6;&#x901A;&#x4FE1;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF1B;</p>
<p>&#xA0; Openfire&#x662F;&#x57FA;&#x4E8E;Jabber&#x534F;&#x8BAE;(XMPP)&#x5B9E;&#x73B0;&#x7684;&#x5373;&#x65F6;&#x901A;&#x4FE1;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x7248;&#x672C;&#xFF0C;&#x7F51;&#x4E0A;&#x5F88;&#x5BB9;&#x6613;&#x627E;&#x5230;&#x5F00;&#x53D1;&#x5305;&#xFF0C;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#x80FD;&#x627E;&#x5230;&#x7684;&#x6700;&#x65B0;&#x5F00;&#x53D1;&#x5305;;</p>
<p>&#xA0; Spark&#x652F;&#x6301;&#x804A;&#x5929;&#x3001;&#x8BED;&#x97F3;&#x3001;&#x89C6;&#x9891;&#x3001;&#x622A;&#x5C4F;&#x3001;&#x4F1A;&#x8BAE;&#x3001;&#x6587;&#x4EF6;&#x6536;&#x53D1;&#x3001;&#x8FDE;&#x63A5;MSN&#x7B49;&#x529F;&#x80FD;&#xFF0C;&#x6211;&#x672A;&#x627E;&#x5230;android&#x65B9;&#x9762;&#x7684;&#x652F;&#x6301;&#xFF0C;&#x5404;&#x4F4D;&#x535A;&#x53CB;&#x82E5;&#x6709;&#x8C22;&#x8C22;&#x5206;&#x4EAB;&#xFF1B;</p>
<p>&#xA0; Smack&#x662F;&#x5373;&#xFFFD;&#xFFFD;&#xFFFD;&#x901A;&#x4FE1;&#x5BA2;&#x6237;&#x7AEF;&#x7F16;&#x7A0B;&#x5E93;&#xFF0C;&#x662F;&#x57FA;&#x4E8E;XMPP&#x7684;java&#x5B9E;&#x73B0;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x5957;&#x53EF;&#x6269;&#x5C55;&#x7684;API&#xFF0C;&#x800C;Asmack&#x662F;&#x8BE5;&#x7F16;&#x7A0B;&#x5E93;&#x7684;android&#x7248;&#x672C;&#xFF0C;&#x8FD9;&#x662F;&#x672C;&#x6587;&#x4ECB;&#x7ECD;&#x7684;&#x91CD;&#x70B9;&#xFF1B;</p>
<p>&#xA0; 1.&#x4EC0;&#x4E48;&#x662F;XMPP&#xFF1F;</p>
<p>&#xA0; &#x767E;&#x5EA6;&#x767E;&#x79D1;&#x4E0A;&#x89E3;&#x91CA;&#x7684;&#x662F;&#x201C;<em>XMPP</em>&#x662F;&#x4E00;&#x79CD;&#x57FA;&#x4E8E;&#x6807;&#x51C6;&#x901A;&#x7528;&#x6807;&#x8BB0;&#x8BED;&#x8A00;&#x7684;&#x5B50;&#x96C6;XML&#x7684;&#x534F;&#x8BAE;&#x201D;&#xFF0C;&#x7B80;&#x5355;&#x7684;&#x8BF4;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x6536;&#x53D1;&#x6D88;&#x606F;&#x7684;&#x534F;&#x8BAE;&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;&#x534F;&#x8BAE;&#x5C31;&#x662F;&#x57FA;&#x4E8E;XML&#xFF1B;XMPP&#x7684;&#x524D;&#x8EAB;&#x662F;jabber&#xFF0C;&#x7531;&#x4E00;&#x4E2A;&#x5F00;&#x6E90;&#x7EC4;&#x7EC7;&#x4EA7;&#x751F;&#x7684;&#x5373;&#x65F6;&#x901A;&#x4FE1;&#x534F;&#x8BAE;&#xFF0C;&#x540E;&#x6765;&#x7531;IETF&#x5B8C;&#x6210;&#x6807;&#x51C6;&#x5316;&#x5DE5;&#x4F5C;&#xFF1B;</p>
<p>&#xA0; 2.IM</p>
<p>&#xA0; &#x5373;&#x201D;&#x5373;&#x65F6;&#x901A;&#x4FE1;&#x8F6F;&#x4EF6;&#x201C;&#xFF0C;&#x60F3;&#x73B0;&#x5728;&#x56FD;&#x5185;&#x4F7F;&#x7528;&#x4EBA;&#x6BD4;&#x8F83;&#x591A;&#x7684;QQ&#x3001;&#x5FAE;&#x4FE1;&#x7B49;&#x7B49;&#xFF0C;&#x4F46;&#x4ED6;&#x4EEC;&#x91C7;&#x7528;&#x7684;&#x662F;&#x8FD9;&#x4E9B;&#x516C;&#x53F8;&#x81EA;&#x5DF1;&#x7684;&#x901A;&#x4FE1;&#x534F;&#x8BAE;&#xFF0C;&#x5E76;&#x4E0D;&#x5BF9;&#x5916;&#x5F00;&#x653E;&#xFF0C;&#x4E00;&#x822C;&#x7684;&#x516C;&#x53F8;&#x6CA1;&#x6709;&#x8FC7;&#x4E8E;&#x786C;&#x6027;&#x7684;&#x9700;&#x6C42;&#xFF0C;XMPP&#x534F;&#x8BAE;&#x5DF2;&#x7ECF;&#x53EF;&#x4EE5;&#x6EE1;&#x8DB3;&#x6211;&#x4EEC;&#x7684;&#x9700;&#x6C42;&#xFF1B;</p>
<p>&#xA0;&#x63A5;&#x4E0B;&#x6765;&#x5C31;&#x662F;&#x6B63;&#x6587;&#xFF0C;&#x5373;Asmack&#x7684;&#x4F7F;&#x7528;&#xFF1A;</p>
<p>&#xA0;1.&#x5173;&#x4E8E;&#x5F00;&#x53D1;&#x5305;&#xFF0C;&#x5C31;&#x5C3D;&#x91CF;&#x4F7F;&#x7528;&#x80FD;&#x627E;&#x5230;&#x7684;&#x6700;&#x65B0;&#x7684;&#x5F00;&#x53D1;&#x5305;&#xFF0C;&#x5982;&#x679C;&#x9700;&#x8981;&#x8BF7;&#x5728;&#x8BC4;&#x8BBA;&#x533A;&#x7559;&#x4E0B;&#x90AE;&#x7BB1;</p>
<p>&#xA0;2.&#x4E0B;&#x9762;&#x5C31;&#x9010;&#x6B65;&#x8BB2;&#x89E3;&#x76F8;&#x5173;&#x4F7F;&#x7528;&#xFF1A;</p>
<p>&#xA0;&#x4E00;&#x3001;&#x8FDE;&#x63A5;&#xFF0C;&#x8FD9;&#x90E8;&#x5206;&#x91CD;&#x70B9;&#x662F;&#x4E00;&#x4E2A;&#x7C7B;&#xFF0C;&#x4E00;&#x4E2A;&#x76D1;&#x542C;&#x63A5;&#x53E3;</p>
<p>&#xA0; 1.<span>ConnectionConfiguration&#x7C7B;&#xFF0C;&#x8FD9;&#x4E2A;&#x7C7B;&#x662F;&#x7528;&#x6765;&#x914D;&#x7F6E;&#x8FDE;&#x63A5;&#x53C2;&#x6570;&#x7684;&#x7C7B;<br></span></p>
<p><span>&#xA0;&#xA0;</span></p>
<div class="cnblogs_code">
<pre>     <span style="color: #0000ff;">try</span><span style="color: #000000;"> {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">&#x521D;&#x59CB;&#x5316;&#x65F6;&#x4F20;&#x5165;&#x670D;&#x52A1;&#x5668;&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#x53F7;</span>
            connConfig = <span style="color: #0000ff;">new</span><span style="color: #000000;"> ConnectionConfiguration(ChatRoomInfo.openfireAddress, ChatRoomInfo.openfirePort);
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x8BBE;&#x7F6E;&#x767B;&#x5F55;&#x72B6;&#x6001;&#x4E3A;&#x79BB;&#x7EBF;</span>
            connConfig.setSendPresence(<span style="color: #0000ff;">false</span><span style="color: #000000;">);
            connConfig.setSecurityMode(ConnectionConfiguration.SecurityMode.required);
            </span><span style="color: #008000;">//</span><span style="color: #008000;">&#x5141;&#x8BB8;&#x91CD;&#x65B0;&#x8FDE;&#x63A5;</span>
            connConfig.setReconnectionAllowed(<span style="color: #0000ff;">true</span><span style="color: #000000;">);
            </span><span style="color: #008000;">//</span><span style="color: #008000;">&#x670D;&#x52A1;&#x5668;&#x540D;&#x79F0;&#xFF0C;&#x8FD9;&#x4E2A;&#x9700;&#x8981;&#x8DDF;&#x540E;&#x53F0;&#x7EA6;&#x5B9A;&#x597D;</span>
            <span style="color: #000000;">connConfig.setServiceName(ChatRoomInfo.serverName);
            con </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> XMPPConnection(connConfig);<br>            //<span style="color: #ff0000;">&#x7EA2;&#x8272;&#x6807;&#x8BB0;&#x7684;&#x90E8;&#x5206;&#x8BF7;&#x7559;&#x610F;&#xFF0C;&#x540E;&#x9762;&#x4F1A;&#x8BE6;&#x7EC6;&#x8BB2;&#x89E3;</span>
            con.addPacketListener(</span><span style="color: #0000ff;">new</span> ChatPacketListener(<span style="color: #0000ff;">null</span>), <span style="color: #ff0000;">new</span><span style="color: #000000;"><span style="color: #ff0000;"> ChatPacketFilter(context)</span>);<br></span></pre>
<pre><span style="color: #000000;">            connectionListener = <span style="color: #0000ff;">new<span style="color: #000000;"><span style="color: #808000;"> ViConnectionListener</span>(context,mHandler, successful);
            con.addConnectionListener(connectionListener);</span></span></span></pre>
<pre><span style="color: #000000;"><br>            //&#x5F00;&#x59CB;&#x8FDE;&#x63A5;
            con.connect();
            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (con.isConnected()) {
                LogUtil.w(</span>&quot;conn is conn&quot;<span style="color: #000000;">);</span><span style="color: #008000;">//</span><span style="color: #008000;">con.addPacketListener(new ChatPacketListener(null),new PacketTypeFilter(Message.class));</span>
<span style="color: #000000;">            }
            LogUtil.i(</span>&quot;XmppTool......&#x8FDE;&#x540E;&#x63A5;22222222222&quot;<span style="color: #000000;">);
            } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception e) {
        }</span></pre>
</div>
<p>&#xA0; 2.<span>ConnectionListener &#x8FD9;&#x4E2A;&#x63A5;&#x53E3;&#x76D1;&#x542C;&#x8FDE;&#x63A5;&#x72B6;&#x6001;&#xFF0C;&#x4E0A;&#x9762;<span style="color: #000000;"><span style="color: #0000ff;"><span style="color: #000000;"><span style="color: #808000;">ViConnectionListener</span></span></span></span>&#x7C7B;&#x5219;&#x662F;&#x6211;&#x7684;&#x5B9E;&#x73B0;&#x8BE5;&#x63A5;&#x53E3;&#xFF0C;&#x8FD9;&#x4E2A;&#x63A5;&#x53E3;&#x7684;&#x4F5C;&#x7528;&#x5728;&#x4E8E;&#x76D1;&#x542C;XMPP&#x7684;&#x8FDE;&#x63A5;&#x72B6;&#x51B5;&#xFF0C;&#x5982;&#x679C;&#x8FDE;&#x63A5;&#x5931;&#x8D25;&#x7684;&#x60C5;&#x51B5;&#x51FA;&#x73B0;&#xFF0C;&#x81EA;&#x52A8;&#x8FDB;&#x884C;&#x91CD;&#x8FDE;&#xFF0C;&#x53CA;&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x81EA;&#x5DF1;&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1B;<br></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.bankeys.general.chatroom.Utils;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.content.Context;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.bankeys.general.chatroom.Handler.GeneralChatRoomHandler;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.bankeys.general.chatroom.Interface.CharRoomCore;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.bankeys.general.chatroom.Log.LogUtil;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.jivesoftware.smack.ConnectionListener;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.jivesoftware.smack.packet.Presence;

</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * &#x540C;&#x8D26;&#x53F7;&#x767B;&#x5F55;&#x7B49;&#x60C5;&#x51B5;&#x76D1;&#x542C;
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> ViConnectionListener <span style="color: #0000ff;">implements</span><span style="color: #000000;"> ConnectionListener {
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> GeneralChatRoomHandler mHandler;
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> CharRoomCore connectSuccessful;
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Context context;

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     *
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> context
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> mHandler  GeneralChatRoomHandler&#x8FD9;&#x4E2A;&#x662F;handler&#x7684;&#x5B50;&#x7C7B;&#xFF0C;&#x7528;&#x6765;&#x5904;&#x7406;&#x8FD9;&#x91CC;&#x7684;&#x5404;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x53EF;&#x4EE5;&#x89C6;&#x60C5;&#x51B5;&#x800C;&#x5B9A;
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> connectSuccessful  &#x8FD9;&#x4E2A;&#x63A5;&#x53E3;&#x73B0;&#x5728;&#x770B;&#x663E;&#x5F97;&#x6709;&#x4E9B;&#x591A;&#x4F59;&#xFF0C;&#x6BD5;&#x7ADF;&#x6709;handler&#x6765;&#x5904;&#x7406;&#x4E86; &#x5C31;&#x4E0D;&#x9700;&#x8981;&#x4E86;&#xFF0C;&#x4E0D;&#x8FC7;&#x6682;&#x65F6;&#x5148;&#x653E;&#x5728;&#x8FD9;&#x91CC;&#x4E0D;&#x5F71;&#x54CD;
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">public</span><span style="color: #000000;"> ViConnectionListener(Context context,GeneralChatRoomHandler mHandler, CharRoomCore connectSuccessful) {
        </span><span style="color: #0000ff;">this</span>.mHandler =<span style="color: #000000;"> mHandler;
        </span><span style="color: #0000ff;">this</span>.connectSuccessful =<span style="color: #000000;"> connectSuccessful;
        </span><span style="color: #0000ff;">this</span>.context =<span style="color: #000000;"> context;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> connectionClosed() {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">&#x8FDE;&#x63A5;&#x5173;&#x95ED;</span>
        LogUtil.i(&quot;---------connectionClosed---------&quot;<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> connectionClosedOnError(Exception e) {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">&#x8FDE;&#x63A5;&#x9519;&#x8BEF;&#x5173;&#x95ED;&#xFF0C;&#x9519;&#x8BEF;&#x8FDE;&#x63A5;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x53C2;&#x8003;&#x4E0B;&#x5C31;&#x884C;&#xFF0C;&#x8FD9;&#x90E8;&#x5206;&#x76EE;&#x524D;&#x8FD8;&#x6CA1;&#x6D4B;&#x8BD5;</span>
        LogUtil.i(&quot;ViConnectionListener--&gt;connectionClosedOnError&quot;<span style="color: #000000;">);
        </span><span style="color: #0000ff;">if</span> (e.getMessage().contains(&quot;conflict&quot;)) { <span style="color: #008000;">//
</span>            LogUtil.i(&quot;ViConnectionListener--&gt;&#x540C;&#x4E00;&#x8D26;&#x53F7;&#x767B;&#x9646;&quot;<span style="color: #000000;">);
            </span><span style="color: #0000ff;">if</span> (mHandler != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
                mHandler.obtainMessage(</span>4<span style="color: #000000;">).sendToTarget();
            </span><span style="color: #008000;">//</span><span style="color: #008000;">&#x5173;&#x95ED;&#x8FDE;&#x63A5;&#xFF0C;&#x7531;&#x4E8E;&#x662F;&#x88AB;&#x4EBA;&#x6324;&#x4E0B;&#x7EBF;&#xFF0C;&#x53EF;&#x80FD;&#x662F;&#x7528;&#x6237;&#x81EA;&#x5DF1;&#xFF0C;&#x6240;&#x4EE5;&#x5173;&#x95ED;&#x8FDE;&#x63A5;&#xFF0C;&#x8BA9;&#x7528;&#x6237;&#x91CD;&#x65B0;&#x767B;&#x5F55;&#x662F;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x597D;&#x7684;&#x9009;&#x62E9;</span>
<span style="color: #000000;">            XmppTool.getInstance().closeConnection();
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x63A5;&#x4E0B;&#x6765;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x5E7F;&#x64AD;&#xFF0C;&#x63D0;&#x793A;&#x7528;&#x6237;&#x88AB;&#x6324;&#x4E0B;&#x7EBF;&#xFF0C;&#x63D0;&#x793A;&#x7528;&#x6237;&#x91CD;&#x65B0;&#x767B;&#x5F55;</span>
        } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (e.getMessage().contains(&quot;Connection timed out&quot;)) {<span style="color: #008000;">//</span><span style="color: #008000;"> &#x8FDE;&#x63A5;&#x8D85;&#x65F6;</span>
            LogUtil.i(&quot;ViConnectionListener &#x6B63;&#x5728;&#x91CD;&#x8FDE;......&#x2B1;&quot;<span style="color: #000000;">);

        } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (e.getMessage().contains(&quot;system-shutdown&quot;)) {     <span style="color: #008000;">//</span><span style="color: #008000;"> &#x670D;&#x52A1;&#x5668;&#x5173;&#x95ED;</span>
            LogUtil.w(&quot;&#x670D;&#x52A1;&#x5668;&#x5173;&#x95ED;&quot;<span style="color: #000000;">);
            </span><span style="color: #0000ff;">if</span> (mHandler != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
                mHandler.obtainMessage(</span>5<span style="color: #000000;">).sendToTarget();
        }
        LogUtil.i(e.getMessage());
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> reconnectingIn(<span style="color: #0000ff;">int</span><span style="color: #000000;"> arg0) {
        LogUtil.i(</span>&quot;ViConnectionListener--&gt;reconnectingIn &#x6B63;&#x5728;&#x91CD;&#x65B0;&#x8FDE;&#x63A5;......&quot;<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> reconnectionFailed(Exception arg0) {
        LogUtil.i(</span>&quot;ViConnectionListener--&gt;reconnectionFailed  &#x91CD;&#x65B0;&#x8FDE;&#x63A5;&#x5931;&#x8D25;......&quot;<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> reconnectionSuccessful() {
        LogUtil.i(</span>&quot;&#x8FDE;&#x63A5;&#x6210;&#x529F;/&#x767B;&#x9646;&#x6210;&#x529F;......&quot;<span style="color: #000000;">);
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x8BBE;&#x7F6E;&#x767B;&#x5F55;&#x72B6;&#x6001;&#xFF1A;&#x5728;&#x7EBF;</span>
        Presence presence = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Presence(Presence.Type.available);
        XmppTool.getInstance().getConnection(context,mHandler, connectSuccessful).sendPacket(presence);
        </span><span style="color: #0000ff;">if</span> (connectSuccessful != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            connectSuccessful.onConnectSuccessful();
        }
    }


}</span></pre>
</div>
<p>&#xA0; &#x8FD9;&#x91CC;&#x8981;&#x6DFB;&#x52A0;&#x4E00;&#x70B9;&#x8BF4;&#x660E;&#xFF0C;&#x5728;&#x6211;&#x4EEC;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x6216;&#x8005;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x4E4B;&#x524D;&#x8BB0;&#x5F97;&#x52A0;&#x4E0A;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<div class="cnblogs_code">
<pre>    <span style="color: #008000;">//</span><span style="color: #008000;"> &#x9759;&#x6001;&#x52A0;&#x8F7D;ReconnectionManager ,&#x91CD;&#x8FDE;&#x540E;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;</span>
    <span style="color: #0000ff;">static</span><span style="color: #000000;"> {
        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
            Class.forName(</span>&quot;org.jivesoftware.smack.ReconnectionManager&quot;<span style="color: #000000;">);
        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception e) {
            e.printStackTrace();
        }
    }</span></pre>
</div>
<p>&#xA0;</p>