<h1>1.<span style="font-family: &#x5B8B;&#x4F53;;">&#x767B;&#x9646;</span><span style="font-family: Calibri;">IM</span></h1>
<p>&#xA0;</p>
<p>Connection.DEBUG_ENABLED&#xA0;=&#xA0;true;//<span style="font-family: &#x5B8B;&#x4F53;;">&#x9996;&#x5148;&#x6FC0;&#x6D3B;&#x8C03;&#x8BD5;&#x6A21;&#x5F0F;</span></p>
<h2>1.1<span style="font-family: &#x5B8B;&#x4F53;;">&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;</span></h2>
<p>&#x9996;&#x5148;&#xFF0C;&#x5728;&#x542F;&#x52A8;<span style="font-family: Calibri;">DSM&#xA0;Message</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x65F6;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x901A;&#x8FC7;</span><span style="font-family: Calibri;">XMPPConnection</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E0E;&#x670D;&#x52A1;&#x5668;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x3002;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x7684;&#x65B9;&#x5F0F;&#x6709;&#x4E24;&#x79CD;&#xFF1A;</span></p>
<p>1.<span style="font-family: &#x5B8B;&#x4F53;;">&#x76F4;&#x63A5;&#x8FDE;&#x5230;&#x670D;&#x52A1;&#x5668;</span></p>
<p>Connection&#xA0;conn&#xA0;=&#xA0;new&#xA0;XMPPConnection(&quot;localhost&quot;);//<span style="font-family: &#x5B8B;&#x4F53;;">&#x521B;&#x5EFA;&#x8FDE;&#x63A5;</span></p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x5176;&#x4E2D;&#x201C;</span><span style="font-family: &apos;Courier New&apos;;">localhost</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x201D;&#x662F;&#x670D;&#x52A1;&#x5668;&#x5730;&#x5740;&#xFF0C;&#x7531;&#x4E8E;&#x6211;&#x7528;&#x7684;&#x662F;&#x672C;&#x673A;&#xFF0C;&#x6240;&#x4EE5;&#x662F;&#x201C;</span><span style="font-family: &apos;Courier New&apos;;">localhost</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x201D;&#x3002;</span></p>
<p>conn.connect();//<span style="font-family: &#x5B8B;&#x4F53;;">&#x63A5;&#x901A;&#x8FDE;&#x63A5;</span></p>
<p>2.<span style="font-family: &#x5B8B;&#x4F53;;">&#x6839;&#x636E;&#x914D;&#x7F6E;&#x8FDE;&#x63A5;</span></p>
<p>ConnectionConfiguration&#xA0;config&#xA0;=&#xA0;ConnectionConfiguration();</p>
<p>config.set<a href="file:///Applications/WizNote.app/Contents/Resources/files/editor/index.html#getServiceName%28%29">ServiceName</a>(&quot;localhost&quot;)&#xFF1B;<span style="font-family: &apos;Courier New&apos;;">//</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8FD8;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x5F88;&#x591A;&#x5176;&#x4ED6;&#x5C5E;&#x6027;&#xFF0C;&#x5982;&#x9690;&#x8EAB;&#x767B;&#x9646;</span></p>
<p>Connection&#xA0;conn1&#xA0;=&#xA0;new&#xA0;XMPPConnection(config);</p>
<p>conn1.connect();</p>
<p>&#xA0;</p>
<h2>1.2<span style="font-family: &#x5B8B;&#x4F53;;">&#x7528;&#x6237;&#x767B;&#x9646;</span></h2>
<p>&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x4E4B;&#x540E;&#x5C31;&#x662F;&#x7528;&#x6237;&#x767B;&#x9646;&#x4E86;&#xFF0C;<span style="font-family: &apos;Courier New&apos;;">openfire</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x652F;&#x6301;&#x591A;&#x7EC8;&#x7AEF;&#x767B;&#x9646;&#x7684;&#xFF0C;&#x4E0B;&#x9762;&#x7684;</span><span style="font-family: &apos;Courier New&apos;;">resource</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5C31;&#x662F;&#x6307;&#x7684;&#x662F;&#x7EC8;&#x7AEF;&#x540D;&#x79F0;&#xFF0C;&#x5982;</span><span style="font-family: &apos;Courier New&apos;;">Smack</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3001;</span><span style="font-family: &apos;Courier New&apos;;">Spark</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7B49;&#x3002;&#x767B;&#x9646;&#x7684;&#x65B9;&#x6CD5;&#x6709;&#x4E24;&#x4E2A;</span></p>
<p><a href="file:///Applications/WizNote.app/Contents/Resources/files/editor/index.html#login%28java.lang.String,%20java.lang.String,%20java.lang.String%29">login</a>(<a title="class or interface in java.lang" href="http://java.sun.com/j2se/1.3/docs/api/java/lang/String.html?is-external=true">String</a>&#xA0;username,&#xA0;<a title="class or interface in java.lang" href="http://java.sun.com/j2se/1.3/docs/api/java/lang/String.html?is-external=true">String</a>&#xA0;password)&#x548C;</p>
<p><a href="file:///Applications/WizNote.app/Contents/Resources/files/editor/index.html#login%28java.lang.String,%20java.lang.String,%20java.lang.String%29">login</a>(<a title="class or interface in java.lang" href="http://java.sun.com/j2se/1.3/docs/api/java/lang/String.html?is-external=true">String</a>&#xA0;username,&#xA0;<a title="class or interface in java.lang" href="http://java.sun.com/j2se/1.3/docs/api/java/lang/String.html?is-external=true">String</a>&#xA0;password,&#xA0;<a title="class or interface in java.lang" href="http://java.sun.com/j2se/1.3/docs/api/java/lang/String.html?is-external=true">String</a>&#xA0;resource)</p>
<p>&#xA0;</p>
<p>&#x5177;&#x4F53;&#x4F8B;&#x5B50;&#x5982;&#x4E0B;&#xFF0C;<span style="font-family: &apos;Courier New&apos;;">livsun</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E0E;</span><span style="font-family: &apos;Courier New&apos;;">livsun1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x4E24;&#x4E2A;&#x7528;&#x6237;&#xFF0C;&#x5BC6;&#x7801;&#x90FD;&#x662F;</span><span style="font-family: &apos;Courier New&apos;;">111</span></p>
<p>conn.login(&quot;livsun&quot;,&#xA0;&quot;111&quot;,&quot;Smack&quot;);</p>
<p>resource<span style="font-family: &#x5B8B;&#x4F53;;">&#x4E5F;&#x53EF;&#x4EE5;&#x7F3A;&#x7701;&#x4E0D;&#x8BBE;&#x7F6E;</span></p>
<p>conn1.login(&quot;livsun1&quot;,&#xA0;&quot;111&quot;);</p>
<p>&#x672C;&#x6587;&#x540E;&#x9762;&#x9ED8;&#x8BA4;<span style="font-family: &apos;Courier New&apos;;">livsun</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E0E;</span><span style="font-family: &apos;Courier New&apos;;">livsun1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5DF2;&#x7ECF;&#x767B;&#x9646;&#xFF0C;&#x4E14;&#x4E0E;&#x670D;&#x52A1;&#x5668;&#x7684;&#x8FDE;&#x63A5;&#x5206;&#x522B;</span><span style="font-family: &apos;Courier New&apos;;">conn</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x548C;</span><span style="font-family: &apos;Courier New&apos;;">conn1.</span></p>
<p>&#xA0;</p>
<h2>1.3<span style="font-family: &#x5B8B;&#x4F53;;">&#x65AD;&#x5F00;&#x8FDE;&#x63A5;</span></h2>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#x65AD;&#x5F00;&#x8FDE;&#x63A5;&#x53EA;&#x9700;&#x8C03;&#x7528;<span style="font-family: Calibri;">disconnect()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x65B9;&#x6CD5;&#xFF0C;&#x5982;</span><span style="font-family: Calibri;">conn.disconnect();</span></p>
<h1>2.<span style="font-family: &#x5B8B;&#x4F53;;">&#x5355;&#x4EBA;&#x804A;&#x5929;</span></h1>
<h2>2.1<span style="font-family: &#x5B8B;&#x4F53;;">&#x53D1;&#x8D77;&#x4F1A;&#x8BDD;&#x8BF7;&#x6C42;</span></h2>
<p>&#x4F5C;&#x4E3A;&#x4E00;&#x6B3E;<span style="font-family: Calibri;">IM</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8F6F;&#x4EF6;&#x7684;&#x901A;&#x4FE1;&#x534F;&#x8BAE;&#xFF0C;&#x9996;&#x8981;&#x529F;&#x80FD;&#x5C31;&#x662F;&#x804A;&#x5929;&#x3002;&#x804A;&#x5929;&#x5305;&#x542B;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x4E3B;&#x52A8;&#x5411;&#x5176;&#x4ED6;&#x4EBA;&#x53D1;&#x8D77;&#x4F1A;&#x8BDD;&#xFF1B;&#x4E5F;&#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x522B;&#x4EBA;&#x7684;&#x4F1A;&#x8BDD;&#x8BF7;&#x6C42;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x4E3B;&#x52A8;&#x5BF9;&#x522B;&#x4EBA;&#x53D1;&#x8D77;&#x4F1A;&#x8BDD;&#x7684;&#x5B9E;&#x73B0;&#xFF1A;</span></p>
<p>conn.getChatManager.createChat(String&#xA0;userID,&#xA0;MessageListener&#xA0;listener)</p>
<p>&#x5176;&#x4E2D;<span style="font-family: Calibri;">userID</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x672C;&#x6B21;&#x5BF9;&#x8BDD;&#x8BF7;&#x6C42;&#x7684;&#x63A5;&#x6536;&#x65B9;&#x7684;&#x6807;&#x5FD7;&#xFF0C;&#x5982;</span><span style="font-family: Calibri;">UserID</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;</span><span style="font-family: Calibri;">livsun1@z00189374/Smack</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;</span><span style="font-family: Calibri;">livsun1@z00189374</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x5BF9;&#x8BDD;&#x8BF7;&#x6C42;&#x7684;&#x63A5;&#x6536;&#x65B9;&#xFF0C;</span><span style="font-family: Calibri;">/Smack</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8BF4;&#x660E;&#x7528;&#x6237;&#x662F;&#x5728;&#x54EA;&#x4E2A;&#x7EC8;&#x7AEF;&#x767B;&#x9646;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x7F3A;&#x7701;&#x4E0D;&#x5199;&#x3002;</span></p>
<p>&#xA0;</p>
<h3>2.1.1<span style="font-family: &#x5B8B;&#x4F53;;">&#x6D88;&#x606F;&#x76D1;&#x542C;</span></h3>
<p>&#x5F53;&#x60F3;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x53D1;&#x8D77;&#x4F1A;&#x8BDD;&#x8BF7;&#x6C42;&#xFF0C;&#x5BF9;&#x65B9;&#x63A5;&#x53D7;&#x8BF7;&#x6C42;&#x5E76;&#x521B;&#x5EFA;&#x4F1A;&#x8BDD;&#x540E;&#xFF0C;&#x5BF9;&#x65B9;&#x53EF;&#x80FD;&#x53D1;&#x9001;&#x6D88;&#x606F;&#x56DE;&#x6765;&#xFF0C;&#x8FD9;&#x65F6;&#x9700;&#x8981;&#x5BF9;&#x63A5;&#x53D7;&#x7684;&#x6D88;&#x606F;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;&#x8FD9;&#x91CC;&#x8981;&#x7528;&#x5230;<span style="font-family: Calibri;">MessageListener</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;</span></p>
<p>&#x4E0B;&#x4F8B;&#x5C06;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x5E76;&#x5BF9;&#x6536;&#x5230;&#x7684;&#x6D88;&#x606F;&#x8FDB;&#x884C;&#x8F93;&#x51FA;&#xFF1A;</p>
<p>Chat&#xA0;chat&#xA0;=&#xA0;conn.getChatManager().createChat(&quot;livsun1@z00189374/Smack&quot;,&#xA0;new&#xA0;MessageListener(){</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;void&#xA0;processMessage(Chat&#xA0;chat0,&#xA0;Message&#xA0;message)</p>
<p>&#xA0;&#xA0;&#xA0;{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;System.out.println(&quot;&#x6765;&#x81EA;<span style="font-family: &apos;Courier New&apos;;">livsun1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x5185;&#x5BB9;&#x4E3A;</span>&quot;+message.getBody());&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</p>
<p>&#xA0;&#xA0;&#xA0;}</p>
<p>});</p>
<p>&#x7EA2;&#x8272;<span style="font-family: &apos;Courier New&apos;;">chat</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x8FD9;&#x6B21;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8BDD;&#x5BF9;&#x8C61;&#xFF0C;&#x5B83;&#x5728;</span><span style="font-family: &apos;Courier New&apos;;">livsun</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8DDF;</span><span style="font-family: &apos;Courier New&apos;;">livsun1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E4B;&#x95F4;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x8FDE;&#x63A5;&#xFF1B;&#x540C;&#x4E8B;&#x5904;&#x7406;&#x6765;&#x81EA;</span><span style="font-family: &apos;Courier New&apos;;">livsun1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x6D88;&#x606F;&#x3002;&#x5982;&#x679C;</span><span style="font-family: &apos;Courier New&apos;;">livsun</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x60F3;&#x8981;&#x53D1;&#x6D88;&#x606F;&#xFF0C;&#x9700;&#x8981;&#x7528;</span><span style="font-family: &apos;Courier New&apos;;">chat</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x8C03;&#x7528;</span><span style="font-family: &apos;Courier New&apos;;">sendMessage</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x65B9;&#x6CD5;&#x3002;</span></p>
<p>&#x5177;&#x4F53;&#x53EF;&#x89C1;&#x4E0B;&#x4F8B;&#xFF1A;</p>
<p>chat.sendMessage(&quot;Hello,I&#x2019;m&#xA0;livsun&quot;);</p>
<p>&#xA0;</p>
<h3>2.1.2<span style="font-family: &#x5B8B;&#x4F53;;">&#x4F1A;&#x8BDD;&#x8BF7;&#x6C42;&#x76D1;&#x542C;</span></h3>
<p>&#x901A;&#x8FC7;&#x4E0A;&#x9762;&#x4F8B;&#x5B50;&#x53EF;&#x4EE5;&#x77E5;&#x9053;<span style="font-family: &apos;Courier New&apos;;">livsun</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x600E;&#x6837;&#x53D1;&#x9001;&#x4E86;&#x4E00;&#x4E2A;&#x6D88;&#x606F;&#x7ED9;</span><span style="font-family: &apos;Courier New&apos;;">livusn1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;&#x4F46;&#x662F;</span><span style="font-family: &apos;Courier New&apos;;">livsun1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x9700;&#x8981;&#x77E5;&#x9053;&#x4F55;&#x65F6;</span><span style="font-family: &apos;Courier New&apos;;">livsun</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x53D1;&#x4E86;&#x4E00;&#x4E2A;&#x6D88;&#x606F;&#x7ED9;&#x81EA;&#x5DF1;&#xFF0C;&#x540C;&#x65F6;&#x8FD8;&#x8981;&#x5BF9;&#x8FD9;&#x4E2A;&#x6D88;&#x606F;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;</span><span style="font-family: &apos;Courier New&apos;;">Smack</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x63D0;&#x4F9B;&#x4E86;&#x4F1A;&#x8BDD;&#x8BF7;&#x6C42;&#x76D1;&#x542C;&#x63A5;&#x53E3;</span><span style="font-family: &apos;Courier New&apos;;">ChatManagerListener</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x901A;&#x8FC7;&#x5B9E;&#x73B0;&#x8BE5;&#x63A5;&#x53E3;&#xFF0C;&#x6765;&#x76D1;&#x542C;&#x6CA1;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x7684;&#x521B;&#x5EFA;&#x8BF7;&#x6C42;&#x3002;&#x8FD9;&#x91CC;&#x518D;&#x4EE5;</span><span style="font-family: &apos;Courier New&apos;;">livsun1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E3A;&#x4F8B;&#x6765;&#x5C55;&#x793A;&#x4E00;&#x4E0B;&#xFF1A;</span></p>
<p>chat.getChatManager.&#xA0;<a href="file:///Applications/WizNote.app/Contents/Resources/files/editor/index.html#addChatListener%28org.jivesoftware.smack.ChatManagerListener%29">addChatListener</a>(<a title="interface in org.jivesoftware.smack" href="http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smack/ChatManagerListener.html">ChatManagerListener</a>&#xA0;listener)</p>
<p>&#xA0;</p>
<p>ChatManagerListener<span style="font-family: &#x5B8B;&#x4F53;;">&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;</span><a href="file:///Applications/WizNote.app/Contents/Resources/files/editor/index.html#chatCreated%28org.jivesoftware.smack.Chat,%20boolean%29">chatCreated</a>(<a title="class in org.jivesoftware.smack" href="http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smack/Chat.html">Chat</a>&#xA0;chat,&#xA0;boolean&#xA0;createdLocally)&#xFF0C;&#x5B83;&#x7528;&#x6765;&#x5904;&#x7406;&#x5F53;<span style="font-family: &apos;Courier New&apos;;">chat</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x521B;&#x5EFA;&#x65F6;&#x7684;&#x5177;&#x4F53;&#x64CD;&#x4F5C;&#x3002;</span></p>
<p>&#xA0;</p>
<p>&#x5177;&#x4F53;&#x8BF7;&#x770B;&#x4E0B;&#x9762;&#x4F8B;&#x5B50;&#xFF1A;</p>
<p>conn1.getChatManager().addChatListener(</p>
<p>new&#xA0;ChatManagerListener(){</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;void&#xA0;chatCreated(Chat&#xA0;chat,&#xA0;boolean&#xA0;createdLocal)</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;{</p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x81EA;&#x5DF1;&#x521B;&#x5EFA;&#x662F;&#x6307;&#x81EA;&#x5DF1;&#x8C03;&#x7528;</span><span style="font-family: &apos;Courier New&apos;;">createChat</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x4E5F;&#x4F1A;&#x89E6;&#x53D1;&#x8FD9;&#x4E2A;</span><span style="font-family: &apos;Courier New&apos;;">listener</span></p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x5728;&#x521B;&#x5EFA;&#x5BF9;&#x8BDD;&#x65F6;&#x5C31;&#x4F1A;&#x5236;&#x5B9A;</span><span style="font-family: &apos;Courier New&apos;;">MessageListener</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;&#x8FD9;&#x6837;&#x5224;&#x65AD;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x91CD;&#x590D;&#x5B9A;&#x4E49;</span><span style="font-family: &apos;Courier New&apos;;">//MessageLister</span></p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if(createdLocal)</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;System.out.println(&quot;&#x8FD9;&#x4E2A;<span style="font-family: &apos;Courier New&apos;;">chat</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x81EA;&#x5DF1;&#x521B;&#x5EFA;&#x7684;</span>&quot;);</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}</p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x521B;&#x5EFA;&#x4E0E;</span><span style="font-family: &apos;Courier New&apos;;">livsun</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x5BF9;&#x8BDD;&#xFF0C;&#x8FD9;&#x91CC;&#x9762;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;</span><span style="font-family: &apos;Courier New&apos;;">message</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x83B7;&#x53D6;&#x53D1;&#x9001;&#x804A;&#x5929;&#x8BF7;&#x6C42;&#x7684;&#x4EBA;&#x4FE1;&#x606F;</span></p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;else</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;System.out.println(&quot;&#x522B;&#x4EBA;&#x60F3;&#x8DDF;&#x6211;&#x804A;&#x5929;&quot;);</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;chat.addMessageListener(new&#xA0;MessageListener(){</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;void&#xA0;processMessage(Chat&#xA0;chat,&#xA0;Message&#xA0;message)</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;System.out.println(message.getFrom+&quot;&#x60F3;&#x8DDF;&#x6211;&#x804A;&#x5929;<span style="font-family: &apos;Courier New&apos;;">)</span></p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;chat.sendMessage(&quot;&#x4F60;&#x597D;&quot;);</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;});</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;});</p>
<p>&#xA0;</p>
<h3>2.1.3<span style="font-family: &#x5B8B;&#x4F53;;">&#x4F1A;&#x8BDD;&#x72B6;&#x6001;&#x76D1;&#x542C;</span></h3>
<p>&#x901A;&#x5E38;&#x7528;&#x6237;&#x5728;&#x53C2;&#x52A0;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x65F6;&#xFF0C;&#x60F3;&#x77E5;&#x9053;&#x53E6;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x662F;&#x5426;&#x6B63;&#x5728;&#x8F93;&#x5165;&#x3002;&#x4F1A;&#x8BDD;&#x72B6;&#x6001;&#x6709;&#x4E94;&#x79CD;&#xFF1A;<span style="font-family: Calibri;">active</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF08;&#x53C2;&#x52A0;&#x4F1A;&#x8BDD;&#xFF09;</span><span style="font-family: Calibri;">,&#xA0;composing</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF08;&#x6B63;&#x5728;&#x8F93;&#x5165;&#xFF09;</span><span style="font-family: Calibri;">,&#xA0;gone</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF08;&#x79BB;&#x5F00;&#xFF09;</span><span style="font-family: Calibri;">,&#xA0;inactive</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF08;&#x6CA1;&#x6709;&#x53C2;&#x52A0;&#x4F1A;&#x8BDD;&#xFF09;</span><span style="font-family: Calibri;">,&#xA0;paused</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF08;&#x6682;&#x505C;&#x8F93;&#x5165;&#xFF09;&#x3002;</span></p>
<p>&#x5982;&#x679C;&#x60F3;&#x8981;&#x5BF9;&#x4F1A;&#x8BDD;&#x72B6;&#x6001;&#x76D1;&#x542C;&#xFF0C;&#x9700;&#x8981;&#x5728;&#x7528;&#x6237;&#x767B;&#x9646;&#x4E4B;&#x540E;&#xFF0C;&#x4F1A;&#x8BDD;&#x5EFA;&#x7ACB;&#x4E4B;&#x524D;&#xFF0C;&#x6DFB;&#x52A0;<span style="font-family: Calibri;">ChatStateManager</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5BF9;&#x8C61;&#xFF0C;&#x65B9;&#x6CD5;&#x4E3A;</span><span style="font-family: Calibri;">ChatStateManager.getInstance(XPMMConnectio&#xA0;&#xA0;conn);</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8B6C;&#x5982;&#x83B7;&#x53D6;</span><span style="font-family: Calibri;">livsun</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8FDE;&#x63A5;&#x7684;</span><span style="font-family: Calibri;">ChatStateManager</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4EE3;&#x7801;&#x662F;</span>ChatStateManager&#xA0;csm&#xA0;=&#xA0;ChatStateManager(conn);</p>
<p>&#x5728;&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x6839;&#x636E;&#x7528;&#x6237;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x7684;&#x4E0D;&#x540C;&#x64CD;&#x4F5C;&#xFF0C;&#x901A;&#x8FC7;<span style="font-family: Calibri;">ChatStateManager</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8C03;&#x7528;&#x65B9;&#x6CD5;</span><a href="file:///Applications/WizNote.app/Contents/Resources/files/editor/index.html#setCurrentState%28org.jivesoftware.smackx.ChatState,%20org.jivesoftware.smack.Chat%29">setCurrentState</a>(<a title="enum in org.jivesoftware.smackx" href="http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smackx/ChatState.html">ChatState</a>&#xA0;newState,&#xA0;<a title="class in org.jivesoftware.smack" href="http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smack/Chat.html">Chat</a>&#xA0;chat)&#x6765;&#x8BBE;&#x7F6E;&#x4F1A;&#x8BDD;&#x7684;&#x5373;&#x65F6;&#x72B6;&#x6001;&#x3002;&#x5982;&#x5F53;<span style="font-family: Calibri;">livsun</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6B63;&#x5728;&#x6253;&#x5B57;&#x8F93;&#x5165;&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;</span><span style="font-family: Calibri;">csm.setCurrentState(ChatState.composing,&#xA0;chat)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x8BBE;&#x7F6E;&#x72B6;&#x6001;&#x4E3A;&#x6B63;&#x5728;&#x8F93;&#x5165;&#x3002;</span></p>
<p>&#x5728;&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x5BF9;&#x4F1A;&#x8BDD;&#x72B6;&#x6001;&#x6539;&#x53D8;&#x8FDB;&#x884C;&#x76D1;&#x542C;&#xFF0C;<span style="font-family: Calibri;">ChatStateListener</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7EE7;&#x627F;</span>MessageListener&#xFF0C;</p>
<p>&#x65B9;&#x6CD5;&#x662F;<a href="file:///Applications/WizNote.app/Contents/Resources/files/editor/index.html#stateChanged%28org.jivesoftware.smack.Chat,%20org.jivesoftware.smackx.ChatState%29">stateChanged</a>(<a title="class in org.jivesoftware.smack" href="http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smack/Chat.html">Chat</a>&#xA0;chat,&#xA0;<a title="enum in org.jivesoftware.smackx" href="http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smackx/ChatState.html">ChatState</a>&#xA0;state)&#xFF0C;&#x7531;&#x4E8E;<span style="font-family: Calibri;">Chat</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7C7B;&#x6CA1;&#x6709;&#x76F4;&#x63A5;&#x6DFB;&#x52A0;</span><span style="font-family: Calibri;">ChatStateListener</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x7F16;&#x5199;&#x4E00;&#x4E2A;&#x5185;&#x90E8;&#x7C7B;&#x5B9E;&#x73B0;</span><span style="font-family: Calibri;">ChatStateListener</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x548C;</span><span style="font-family: Calibri;">MessageListener</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E24;&#x4E2A;&#x63A5;&#x53E3;&#x3002;</span></p>
<p>&#x8BF7;&#x770B;&#x4F8B;&#x5B50;&#xFF1A;</p>
<p>private&#xA0;class&#xA0;SelfListener&#xA0;implements&#xA0;ChatStateListener,&#xA0;MessageListener{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;void&#xA0;stateChanged(Chat&#xA0;arg0,&#xA0;ChatState&#xA0;arg1){</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#x2026;&#x2026;</p>
<p>}</p>
<p>Public&#xA0;void&#xA0;processMessage(Chat&#xA0;arg0,&#xA0;Message&#xA0;arg1){</p>
<p>&#x2026;&#x2026;</p>
<p>}</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;}</p>
<p>MessageListener&#xA0;messageListener&#xA0;=&#xA0;new&#xA0;SelfListener();</p>
<p>&#x8FD9;&#x6837;&#x5F53;&#x4F1A;&#x8BDD;&#x5BF9;&#x65B9;&#x7684;<span style="font-family: Calibri;">ChatState</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x53D1;&#x751F;&#x6539;&#x53D8;&#x65F6;&#xFF0C;</span><span style="font-family: Calibri;">stateChanged</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x65B9;&#x6CD5;&#x5C31;&#x88AB;&#x89E6;&#x53D1;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x63A5;&#x6536;&#x5230;&#x4E00;&#x4E2A;&#x5185;&#x5BB9;&#x4E3A;&#x7A7A;&#x7684;</span><span style="font-family: Calibri;">Message</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;</span><span style="font-family: Calibri;">Message</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x91CC;&#x901A;&#x77E5;</span><span style="font-family: Calibri;">ChatState</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6539;&#x53D8;&#x3002;</span></p>
<h2>2.2<span style="font-family: &#x5B8B;&#x4F53;;">&#x6D88;&#x606F;</span></h2>
<h3>2.2.1<span style="font-family: &#x5B8B;&#x4F53;;">&#x8BBE;&#x7F6E;&#x6D88;&#x606F;&#x7684;&#x5C5E;&#x6027;</span></h3>
<p>&#x53D1;&#x9001;&#x6D88;&#x606F;&#x7684;&#x65B9;&#x6CD5;<span style="font-family: Calibri;">sendMessage()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;&#x5B83;&#x6709;&#x4E24;&#x79CD;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#xFF0C;</span><span style="font-family: Calibri;">sendMessage(String&#xA0;text)&#xA0;</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x548C;</span><span style="font-family: Calibri;">sendMessage(Message&#xA0;message)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;&#x7B2C;&#x4E00;&#x79CD;&#x5C31;&#x662F;&#x4E0A;&#x9762;&#x4F8B;&#x5B50;&#x4E2D;&#x6240;&#x7528;&#x7684;&#xFF0C;&#x76F4;&#x63A5;&#x4EE5;</span><span style="font-family: Calibri;">String</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E3A;&#x5BF9;&#x8C61;&#xFF0C;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x6D88;&#x606F;&#x3002;</span></p>
<p>&#x4E3A;&#x4E86;&#x6EE1;&#x8DB3;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x9700;&#x6C42;&#xFF0C;<span style="font-family: Calibri;">Smack</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x63D0;&#x4F9B;&#x4E86;&#x7B2C;&#x4E8C;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x4E3A;</span><span style="font-family: Calibri;">message</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6DFB;&#x52A0;&#x4E00;&#x4E9B;&#x9644;&#x52A0;&#x5C5E;&#x6027;&#xFF0C;&#x5728;</span><span style="font-family: Calibri;">message</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E2D;&#x4ED6;&#x4EEC;&#x53EA;&#x663E;&#x793A;&#x4E3A;</span><span style="font-family: Calibri;">String</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5B57;&#x6BB5;&#x3002;&#x5728;&#x5BA2;&#x6237;&#x7AEF;&#x63A5;&#x6536;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5904;&#x7406;&#x6765;&#x8BA9;&#x8FD9;&#x4E9B;&#x5B57;&#x6BB5;&#x6709;&#x7279;&#x5B9A;&#x7684;&#x610F;&#x4E49;&#xFF0C;&#x8B6C;&#x5982;&#x8BBE;&#x7F6E;&#x53D1;&#x9001;&#x6587;&#x5B57;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x5B57;&#x4F53;&#xFF0C;&#x989C;&#x8272;&#x7B49;&#x3002;</span></p>
<p>&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x4E86;&#x89E3;<span style="font-family: Calibri;">Message</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8FD9;&#x4E2A;&#x7C7B;&#xFF0C;&#x5B83;&#x6709;&#x4E09;&#x79CD;&#x6784;&#x9020;&#x51FD;&#x6570;&#xFF0C;</span><span style="font-family: Calibri;">Message()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3001;</span><span style="font-family: Calibri;">Message(String&#xA0;text)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x548C;</span><span style="font-family: Calibri;">Message(String&#xA0;text,&#xA0;Message.Type&#xA0;type)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5176;&#x4E2D;</span><span style="font-family: Calibri;">text</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x8981;&#x53D1;&#x9001;&#x7684;&#x5185;&#x5BB9;&#xFF0C;</span><span style="font-family: Calibri;">Message.Type</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5171;&#x6709;&#x4E94;&#x79CD;&#xFF0C;&#x5E38;&#x7528;&#x7684;&#x4E3A;</span><span style="font-family: Calibri;">chat</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x548C;</span><span style="font-family: Calibri;">groupchat</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;</span></p>
<p>Message<span style="font-family: &#x5B8B;&#x4F53;;">&#x4E2D;&#x6709;&#x5F88;&#x591A;&#x65B9;&#x6CD5;&#xFF0C;&#x901A;&#x8FC7;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x6216;&#x8005;&#x53D6;&#x5F97;&#x6D88;&#x606F;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x5982;</span><span style="font-family: Calibri;">addBody()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6DFB;&#x52A0;&#x6D88;&#x606F;&#x5185;&#x5BB9;&#xFF0C;</span><span style="font-family: Calibri;">getBody()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x83B7;&#x5F97;&#x6D88;&#x606F;&#x5185;&#x5BB9;&#xFF0C;</span><span style="font-family: Calibri;">getFrom()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x83B7;&#x53D6;&#x6D88;&#x606F;&#x7684;&#x53D1;&#x9001;&#x8005;&#x7B49;&#x3002;</span><span style="font-family: Calibri;">Message</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8FD8;&#x6709;</span><span style="font-family: Calibri;">API</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E2D;&#x6CA1;&#x6709;&#x63D0;&#x5230;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;</span>setProperty(String&#xA0;name,&#xA0;String&#xA0;value)&#x3002;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x5F88;&#x591A;&#x81EA;&#x5DF1;&#x5B9A;&#x4E49;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x53EF;&#x53C2;&#x89C1;&#x4E0B;&#x9762;&#x4F8B;&#x5B50;&#xFF1A;</p>
<p>Message&#xA0;&#xA0;message&#xA0;&#xA0;=&#xA0;&#xA0;new&#xA0;Message();</p>
<p>message.setBody(&#x201C;This&#xA0;is&#xA0;a&#xA0;Message&#xA0;text&#x201D;);</p>
<p>message.setProperty(&#x201C;color&#x201D;,&#x201D;red&#x201D;);</p>
<p>message.setProperty(&#x201C;size&#x201D;,&#xA0;&#x201C;big&#x201D;);</p>
<p>message.setProperty(&#x201C;isPictureIn&#x201D;,&#x201D;false&#x201D;);</p>
<p>chat.sendMessage(message);</p>
<p>&#x8FD9;&#x6837;&#x5C31;&#x53D1;&#x9001;&#x4E86;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x4E00;&#x4E9B;&#x7279;&#x5B9A;&#x5C5E;&#x6027;&#x7684;&#x6D88;&#x606F;&#x3002;&#x5F53;&#x7528;&#x6237;&#x6536;&#x5230;&#x8FD9;&#x6837;&#x7684;&#x6D88;&#x606F;&#x540E;&#xFF0C;&#x901A;&#x8FC7;&#x8C03;&#x7528;<span style="font-family: Calibri;">message.</span>&#xA0;getPropertyNames()&#x65B9;&#x6CD5;&#x6765;&#x83B7;&#x53D6;&#x6240;&#x6709;&#x5C5E;&#x6027;&#x7684;&#x4E00;&#x4E2A;<span style="font-family: Calibri;">Collection</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;&#x518D;&#x901A;&#x8FC7;</span><span style="font-family: Calibri;">message.getProprety(String&#xA0;name)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x83B7;&#x53D6;&#x540D;&#x4E3A;</span><span style="font-family: Calibri;">name</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5C5E;&#x6027;&#x7684;&#x503C;&#xFF0C;&#x6839;&#x636E;&#x7528;&#x6237;&#x81EA;&#x5DF1;&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;</span><span style="font-family: Calibri;">API</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5982;&#x6539;&#x53D8;&#x6D88;&#x606F;&#x663E;&#x793A;&#x5B57;&#x4F53;&#x989C;&#x8272;&#x3002;</span></p>
<p>&#xA0;</p>
<h3>2.2.2<span style="font-family: &#x5B8B;&#x4F53;;">&#x6D88;&#x606F;&#x72B6;&#x6001;&#x8DDF;&#x8E2A;</span></h3>
<p>&#x5BF9;&#x4E8E;&#x53D1;&#x9001;&#x51FA;&#x53BB;&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x6D88;&#x606F;&#x53D1;&#x9001;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x5982;&#x662F;&#x5426;&#x53D1;&#x9001;&#x6210;&#x529F;&#xFF0C;&#x5BF9;&#x65B9;&#x662F;&#x591F;&#x5904;&#x7406;&#x7B49;&#xFF0C;&#x8FD9;&#x4E9B;&#x529F;&#x80FD;&#x9700;&#x8981;&#x7528;&#x5230;<span style="font-family: Calibri;">MessageEventManager</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;&#x901A;&#x8FC7;&#x8C03;&#x7528;</span><span style="font-family: Calibri;">MessageEventManager.</span>&#xA0;<a href="file:///Applications/WizNote.app/Contents/Resources/files/editor/index.html#addNotificationsRequests%28org.jivesoftware.smack.packet.Message,%20boolean,%20boolean,%20boolean,%20boolean%29">addNotificationsRequests</a>(<a title="class in org.jivesoftware.smack.packet" href="http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smack/packet/Message.html">Message</a>&#xA0;message,&#xA0;boolean&#xA0;offline,&#xA0;boolean&#xA0;delivered,&#xA0;boolean&#xA0;displayed,&#xA0;boolean&#xA0;composing)&#x6765;&#x5BF9;&#x6D88;&#x606F;&#x7684;&#x72B6;&#x6001;&#x8FDB;&#x884C;&#x6807;&#x8BB0;&#x8DDF;&#x8E2A;&#xFF0C;<span style="font-family: Calibri;">message</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E3A;&#x5C06;&#x8981;&#x53D1;&#x9001;&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x5269;&#x4F59;&#x56DB;&#x9879;&#x4E3A;&#x53EF;&#x9009;&#x62E9;&#x7684;&#x8DDF;&#x8E2A;&#x9009;&#x9879;&#xFF0C;</span><span style="font-family: Calibri;">true</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E3A;&#x8DDF;&#x8E2A;&#x3002;</span></p>
<p>&#x5F53;&#x5BF9;&#x5176;&#x4E2D;&#x90E8;&#x5206;&#x9009;&#x9879;&#x8FDB;&#x884C;&#x8DDF;&#x8E2A;&#x540E;&#xFF0C;&#x4E0B;&#x4E00;&#x6B65;&#x64CD;&#x4F5C;&#x5C31;&#x662F;&#x5BF9;&#x8DDF;&#x8E2A;&#x54CD;&#x5E94;&#x7ED3;&#x679C;&#x8FDB;&#x884C;&#x76D1;&#x63A7;&#x3002;&#x6BD4;&#x5982;&#x4F60;&#x60F3;&#x77E5;&#x9053;&#x81EA;&#x5DF1;&#x53D1;&#x9001;&#x6D88;&#x606F;&#x7684;&#x6807;&#x8BB0;&#x7ED3;&#x679C;&#xFF0C;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#xA0;<span style="font-family: Calibri;">MessageEvenetManager</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x8C03;&#x7528;&#x65B9;&#x6CD5;</span><a href="file:///Applications/WizNote.app/Contents/Resources/files/editor/index.html#addMessageEventNotificationListener%28org.jivesoftware.smackx.MessageEventNotificationListener%29">addMessageEventNotificationListener</a>(<a title="interface in org.jivesoftware.smackx" href="http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smackx/MessageEventNotificationListener.html">MessageEventNotificationListener</a>&#xA0;&#xA0;messageEventNotificationListener)&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x60F3;&#x76D1;&#x63A7;&#x662F;&#x5426;&#x6709;&#x4EBA;&#x7ED9;&#x81EA;&#x5DF1;&#x53D1;&#x9001;&#x6D88;&#x606F;&#x8DDF;&#x8E2A;&#x8BF7;&#x6C42;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x9700;&#x8981;&#x8C03;&#x7528;&#x65B9;&#x6CD5;<a href="file:///Applications/WizNote.app/Contents/Resources/files/editor/index.html#addMessageEventRequestListener%28org.jivesoftware.smackx.MessageEventRequestListener%29">addMessageEventRequestListener</a>(<a title="interface in org.jivesoftware.smackx" href="http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smackx/MessageEventRequestListener.html">MessageEventRequestListener</a>&#xA0;messageEventRequestListener)&#x3002;</p>
<p>&#xA0;</p>
<h3>2.2.3<span style="font-family: &#x5B8B;&#x4F53;;">&#x79BB;&#x7EBF;&#x6D88;&#x606F;</span></h3>
<p>&#x53D1;&#x9001;&#x6D88;&#x606F;&#x65F6;&#xFF0C;&#x7528;&#x6237;&#x4E0D;&#x5728;&#x7EBF;&#xFF0C;&#x7CFB;&#x7EDF;&#x4F1A;&#x81EA;&#x52A8;&#x4FDD;&#x5B58;&#x8FD9;&#x4E9B;&#x6D88;&#x606F;&#x3002;&#x5F53;&#x7528;&#x6237;&#x767B;&#x5F55;&#x540E;&#xFF0C;&#x7528;&#x6237;&#x9700;&#x8981;&#x4E3B;&#x52A8;&#x53BB;&#x670D;&#x52A1;&#x5668;&#x83B7;&#x53D6;&#x79BB;&#x7EBF;&#x6D88;&#x606F;&#x3002;&#x4E3B;&#x8981;&#x7528;&#x5230;&#x7684;&#x63A5;&#x53E3;&#x662F;<span style="font-family: Calibri;">OfflineMessageMananger</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;</span></p>
<p>&#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E2A;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x7528;&#x6237;<span style="font-family: Calibri;">login</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x65F6;&#x4E0D;&#x80FD;&#x53D1;&#x9001;</span><span style="font-family: Calibri;">Presence</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF08;&#x7528;&#x6237;&#x72B6;&#x6001;&#xFF0C;&#x8FD9;&#x4E2A;&#x4E0B;&#x7AE0;&#x8BB2;&#xFF09;&#xFF0C;&#x5426;&#x5219;&#x6536;&#x4E0D;&#x5230;&#x79BB;&#x7EBF;&#x6D88;&#x606F;&#x3002;</span></p>
<p>&#x5177;&#x4F53;&#x53EF;&#x4EE5;&#x770B;&#x4E0B;&#x9762;&#x4F8B;&#x5B50;&#xFF1A;</p>
<p>ConnectionConfiguration&#xA0;connConfig&#xA0;=&#xA0;new&#xA0;ConnectionConfiguration(&quot;localhost&quot;);</p>
<p>connConfig.setSendPresence(false);//<span style="font-family: &#x5B8B;&#x4F53;;">&#x8BBE;&#x7F6E;&#x4E0D;&#x53D1;&#x9001;</span><span style="font-family: Calibri;">Presence</span></p>
<p>Connection&#xA0;conn2&#xA0;=&#xA0;new&#xA0;XMPPConnection(connConfig);</p>
<p>Conn2.connect();</p>
<p>Conn2.login(&quot;zhang&quot;,&#xA0;&quot;111&quot;);</p>
<p>OfflineMessageManager&#xA0;omm&#xA0;=&#xA0;new&#xA0;OfflineMessageManager(conn2);//<span style="font-family: &#x5B8B;&#x4F53;;">&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;</span></p>
<p>Iterator&lt;Message&gt;&#xA0;&#xA0;ommlist&#xA0;=&#xA0;omm.getMessages();//<span style="font-family: &#x5B8B;&#x4F53;;">&#x83B7;&#x53D6;&#x6D88;&#x606F;&#xFF0C;&#x7ED3;&#x679C;&#x4E3A;&#x4E00;&#x4E2A;</span><span style="font-family: Calibri;">Message</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8FED;&#x4EE3;&#x5668;</span></p>
<p>omm.deleteMessages();//<span style="font-family: &#x5B8B;&#x4F53;;">&#x5C06;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x7684;&#x79BB;&#x7EBF;&#x6D88;&#x606F;&#x5220;&#x9664;&#x3002;</span></p>
<p>&#x5982;&#x679C;&#x4E0D;&#x6267;&#x884C;&#x6700;&#x540E;&#x4E00;&#x6B65;&#x64CD;&#x4F5C;&#x7684;&#x8BDD;&#xFF0C;&#x4E0B;&#x6B21;&#x767B;&#x5F55;&#x8FD9;&#x4E9B;&#x79BB;&#x7EBF;&#x6D88;&#x606F;&#x8FD8;&#x5728;&#x3002;</p>
<p>&#xA0;</p>
<h2>2.3<span style="font-family: &#x5B8B;&#x4F53;;">&#x6587;&#x4EF6;&#x4F20;&#x8F93;</span></h2>
<p>&#x7528;&#x6237;&#x53EF;&#x80FD;&#x5E0C;&#x671B;&#x5411;&#x5176;&#x5B83;&#x7528;&#x6237;&#x53D1;&#x9001;&#x6587;&#x4EF6;&#x3002;&#x5176;&#x5B83;&#x7528;&#x6237;&#x6709;&#x63A5;&#x53D7;&#xFF0C;&#x62D2;&#x7EDD;&#xFF0C;&#x6216;&#x5FFD;&#x7565;&#x7528;&#x6237;&#x7684;&#x8BF7;&#x6C42;&#x3002;<span style="font-family: Calibri;">Smack</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E3A;&#x7528;&#x6237;&#x8F7B;&#x677E;&#x53D1;&#x9001;&#x6587;&#x4EF6;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x63A5;&#x53E3;&#x3002;</span>&#x6682;&#x53EA;&#x5B9E;&#x73B0;&#x6587;&#x4EF6;&#x4F20;&#x8F93;&#xFF0C;&#x6CA1;&#x6709;&#x5B9E;&#x73B0;&#x6587;&#x4EF6;&#x5939;&#x4F20;&#x8F93;&#x3002;</p>
<h3>2.3.1<span style="font-family: &#x5B8B;&#x4F53;;">&#x53D1;&#x9001;&#x6587;&#x4EF6;</span></h3>
<p>&#x8981;&#x53D1;&#x9001;&#x6216;&#x63A5;&#x53D7;&#x6587;&#x4EF6;&#x9996;&#x5148;&#x5FC5;&#x987B;&#x521B;&#x5EFA;<span style="font-family: Calibri;">FileTransferManager</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7C7B;&#x7684;&#x4E00;&#x4E2A;</span>&#x5BF9;&#x8C61;&#xFF0C;&#x521B;&#x5EFA;&#x65B9;&#x6CD5;&#x662F;<span style="font-family: Calibri;">FileTransferManager(XMPPConnection&#xA0;connection)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;&#x5047;&#x8BBE;&#x73B0;&#x5728;</span><span style="font-family: Calibri;">livsun</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4F20;&#x8F93;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;</span><span style="font-family: Calibri;">fileTransferManager&#xA0;=&#xA0;new&#xA0;FileTransferManager(conn);</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x73B0;&#x5728;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x8F93;&#x51FA;&#x7684;&#x6587;&#x4EF6;&#x4F20;&#x8F93;&#x5BF9;&#x8C61;&#x6765;&#x53D1;&#x9001;&#x6587;&#x4EF6;&#x3002;</span></p>
<p>OutgoingFileTransfer&#xA0;outfile&#xA0;=&#xA0;fileTransferManager(UserID)<span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;</span><span style="font-family: Calibri;">UserID</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E3A;&#x5B8C;&#x5168;</span><span style="font-family: Calibri;">ID</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;&#x5982;&#x679C;&#x8981;&#x53D1;&#x9001;&#x6587;&#x4EF6;&#x7ED9;</span><span style="font-family: Calibri;">livsun1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x8BDD;&#xFF0C;&#x8FD9;&#x91CC;</span><span style="font-family: Calibri;">UserID</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E3A;</span>&#x201D;livsun1@z00189374/Smack&#x201D;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x8C03;&#x7528;<span style="font-family: Calibri;">sendFile(file,&#xA0;description)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x53D1;&#x9001;&#x6587;&#x4EF6;&#xFF0C;</span><span style="font-family: Calibri;">file</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x6587;&#x4EF6;&#x5BF9;&#x8C61;&#xFF0C;</span><span style="font-family: Calibri;">description</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x5BF9;&#x6587;&#x4EF6;&#x7684;&#x63CF;&#x8FF0;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x63A5;&#x53D7;&#x65F6;&#x83B7;&#x53D6;&#xFF0C;&#x5E76;&#x63D0;&#x793A;&#x7528;&#x6237;&#xFF0C;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x63CF;&#x8FF0;&#x6765;&#x9009;&#x62E9;&#x662F;&#x5426;&#x63A5;&#x53D7;&#x3002;</span></p>
<p>&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x7684;&#x53D1;&#x9001;&#x6587;&#x4EF6;&#x7684;&#x8FC7;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>FileTransferManager&#xA0;fileTransferManager&#xA0;=&#xA0;new&#xA0;FileTransferManager(conn);</p>
<p>OutgoingFileTransfer&#xA0;outfile&#xA0;=&#xA0;</p>
<p>manager.createOutgoingFileTransfer(&quot;livsun1@z00189374/Smack&#xA0;&quot;);</p>
<p>outfile.sendFile(new&#xA0;File(&quot;fileToBeSended.txt&quot;),&#xA0;&quot;You&#xA0;won&apos;t&#xA0;believe&#xA0;this!&quot;);</p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<h3>2.3.2<span style="font-family: &#x5B8B;&#x4F53;;">&#x63A5;&#x53D7;&#x6587;&#x4EF6;</span></h3>
<p>&#x5982;&#x679C;&#x60F3;&#x77E5;&#x9053;&#x662F;&#x5426;&#x6709;&#x4EBA;&#x53D1;&#x9001;&#x6587;&#x4EF6;&#x7ED9;&#x81EA;&#x5DF1;&#xFF0C;&#x9996;&#x5148;&#x540C;&#x6837;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;FileTransferManager&#x5BF9;&#x8C61;&#xFF0C;&#x5982;<span style="font-family: Calibri;">FileTransferManager&#xA0;&#xA0;&#xA0;</span>fileTransferManager1&#xA0;&#xA0;=&#xA0;&#xA0;new&#xA0;FileTransferManager(conn1);&#x7136;&#x540E;&#x5BF9;&#x8BE5;&#x5BF9;&#x8C61;&#x6CE8;&#x518C;&#x4E00;&#x4E2A;&#x76D1;&#x542C;&#x5668;<span style="font-family: Calibri;">FileTransferListener</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;&#x6765;&#x76D1;&#x542C;&#x6587;&#x4EF6;&#x4F20;&#x8F93;&#x8BF7;&#x6C42;&#x3002;&#x8FD9;&#x4E2A;&#x76D1;&#x542C;&#x5668;&#x5728;&#x6709;&#x6587;&#x4EF6;&#x4F20;&#x8F93;&#x65F6;&#x88AB;&#x89E6;&#x53D1;&#xFF0C;&#x5B83;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;</span>fileTransferRequest(FileTransferRequest&#xA0;request)&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x6765;&#x51B3;&#x5B9A;&#x6587;&#x4EF6;&#x65F6;&#x63A5;&#x53D7;&#x8FD8;&#x662F;&#x62D2;&#x7EDD;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8981;&#x62D2;&#x7EDD;&#x63A5;&#x53D7;&#xFF0C;&#x53EA;&#x8981;&#x7B80;&#x5355;&#x7684;<span style="font-family: Calibri;">request.reject()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</span></p>
<p>&#x5982;&#x679C;&#x8981;&#x63A5;&#x53D7;&#xFF0C;&#x901A;&#x8FC7;<span style="font-family: Calibri;">request.accept()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x521B;&#x5EFA;&#x4E00;&#x4E2A;</span>IncomingFileTransfer&#x5BF9;&#x8C61;&#xFF0C;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#xFF1A;</p>
<p>IncomingFileTransfer&#xA0;infile&#xA0;=&#xA0;request.accept();<span style="font-family: &#x5B8B;&#x4F53;;">&#x7136;&#x540E;</span><span style="font-family: Calibri;">infile</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8C03;&#x7528;</span><span style="font-family: Calibri;">recieveFile(file)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x8BB2;&#x6587;&#x4EF6;&#x63A5;&#x53D7;&#x5230;</span><span style="font-family: Calibri;">file</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E2D;&#x3002;&#x540C;&#x65F6;&#x8FD8;&#x53EF;&#x4EE5;&#x5BF9;&#x6587;&#x4EF6;&#x4F20;&#x8F93;&#x7684;&#x72B6;&#x6001;&#x8FDB;&#x884C;&#x76D1;&#x542C;&#x3002;</span></p>
<p>&#x76D1;&#x542C;&#x53CA;&#x63A5;&#x53D7;&#x6587;&#x4EF6;&#x7684;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#xFF1A;</p>
<p>&#xA0;&#xA0;final&#xA0;FileTransferManager&#xA0;fileTransferManager1&#xA0;=&#xA0;new&#xA0;FileTransferManager(conn);</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;fileTransferManager1.addFileTransferListener(new&#xA0;FileTransferListener()&#xA0;{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;void&#xA0;fileTransferRequest(FileTransferRequest&#xA0;request)&#xA0;{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;<span style="font-family: &#x5B8B;&#x4F53;;">&#x76D1;&#x67E5;&#x6B64;&#x8BF7;&#x6C42;&#x662F;&#x5426;&#x5E94;&#x8BE5;&#x88AB;&#x63A5;&#x53D7;</span>,shouldAccept<span style="font-family: &#x5B8B;&#x4F53;;">&#x7531;&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;</span></p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if(shouldAccept(request))&#xA0;{//<span style="font-family: &#x5B8B;&#x4F53;;">&#x63A5;&#x53D7;&#x5219;&#x63A5;&#x53D7;&#x6587;&#x4EF6;</span></p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;IncomingFileTransfer&#xA0;infile&#xA0;=&#xA0;request.accept();</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;infile.recieveFile(new&#xA0;File(&quot;FILE_PATH&quot;+infile.getName()));</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;else&#xA0;{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;request.reject();</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;});</p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<h3>2.3.3<span style="font-family: &#x5B8B;&#x4F53;;">&#x6587;&#x4EF6;&#x4F20;&#x8F93;&#x72B6;&#x6001;&#x76D1;&#x542C;</span></h3>
<p>&#x5728;&#x6587;&#x4EF6;&#x4F20;&#x8F93;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x53D1;&#x9001;&#x65B9;&#x6D3B;&#x63A5;&#x6536;&#x65B9;&#x9700;&#x8981;&#x77E5;&#x9053;&#x6587;&#x4EF6;&#x4F20;&#x8F93;&#x7684;&#x8FDB;&#x5EA6;&#x548C;&#x72B6;&#x6001;&#xFF0C;&#x9700;&#x8981;&#x901A;&#x8FC7;<span style="font-family: Calibri;">FileTransfer</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7C7B;&#x6765;&#x5B9E;&#x73B0;&#x3002;</span></p>
<p>IncomingFileTransfer<span style="font-family: &#x5B8B;&#x4F53;;">&#x548C;</span><span style="font-family: Calibri;">OutgoingFileTransfer</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x90FD;&#x7EE7;&#x627F;&#x4E86;</span><span style="font-family: Calibri;">FileTransfer</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7C7B;&#xFF0C;&#x6B64;&#x7C7B;&#x63D0;&#x4F9B;&#x4E00;&#x4E9B;&#x65B9;&#x6CD5;&#x76D1;&#x89C6;&#x6587;&#x4EF6;&#x4F20;&#x8F93;&#x7684;&#x8FDB;&#x5C55;&#xFF1A;</span></p>
<p>&#xA0;getStatus()&#xA0;-&#xA0;<span style="font-family: &#x5B8B;&#x4F53;;">&#x6587;&#x4EF6;&#x4F20;&#x8F93;&#x53EF;&#x4EE5;&#x6709;&#x591A;&#x79CD;&#x72B6;&#x6001;&#xFF0C;&#x534F;&#x5546;&#xFF0C;&#x62D2;&#x7EDD;&#xFF0C;&#x53D6;&#x6D88;&#xFF0C;&#x4F20;&#x8F93;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x9519;&#x8BEF;&#x548C;&#x5B8C;&#x6210;&#x3002;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4F1A;&#x6587;&#x4EF6;&#x4F20;&#x8F93;&#x7684;&#x5F53;&#x524D;&#x72B6;&#x6001;&#x3002;&#xA0;</span></p>
<p>getProgress()&#xA0;-&#xA0;<span style="font-family: &#x5B8B;&#x4F53;;">&#x5982;&#x679C;&#x6587;&#x4EF6;&#x5728;&#x4F20;&#x8F93;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;</span><span style="font-family: Calibri;">0</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5230;</span><span style="font-family: Calibri;">1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x6570;&#x5B57;&#xFF0C;</span><span style="font-family: Calibri;">0</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8868;&#x793A;&#x4F20;&#x8F93;&#x8FD8;&#x6CA1;&#x5F00;&#x59CB;&#xFF0C;</span><span style="font-family: Calibri;">1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8868;&#x793A;&#x4F20;&#x8F93;&#x5B8C;&#x6210;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x5728;&#x4F20;&#x8F93;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E5F;&#x53EF;&#x80FD;&#x8FD4;&#x56DE;</span><span style="font-family: Calibri;">-1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;&#xA0;</span></p>
<p>isDone()&#xA0;-&#xA0;<span style="font-family: &#x5B8B;&#x4F53;;">&#x548C;</span><span style="font-family: Calibri;">getProgress()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x65B9;&#x6CD5;&#x7C7B;&#x4F3C;&#xFF0C;&#x4E0D;&#x540C;&#x7684;&#x662F;&#x5B83;&#x8FD4;&#x56DE;</span><span style="font-family: Calibri;">boolean</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;&#x5982;&#x679C;&#x72B6;&#x6001;&#x4E3A;&#x62D2;&#x7EDD;&#xFF0C;&#x53D6;&#x6D88;&#xFF0C;&#x9519;&#x8BEF;&#x6216;&#x5B8C;&#x6210;&#x8FD4;&#x56DE;&#x771F;&#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE;&#x5047;&#x3002;</span></p>
<p>&#xA0;getError()&#xA0;-&#xA0;<span style="font-family: &#x5B8B;&#x4F53;;">&#x5982;&#x679C;&#x5728;&#x4F20;&#x8F93;&#x8FC7;&#x7A0B;&#x4E2D;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x5C06;&#x4F1A;&#x8FD4;&#x56DE;&#x6240;&#x53D1;&#x751F;&#x7684;&#x9519;&#x8BEF;&#x7684;&#x7C7B;&#x578B;&#x3002;</span></p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#x5982;&#x5728;&#x63A5;&#x6536;&#x65B9;&#x76D1;&#x89C6;&#x6587;&#x4EF6;&#x72B6;&#x6001;&#xFF0C;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>while(!infile.isDone())&#xA0;{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if(infile.getStatus().equals(Status.ERROR))&#xA0;{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;System.out.println(&quot;ERROR!!!&#xA0;&quot;&#xA0;+&#xA0;transfer.getError());</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;else&#xA0;{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;System.out.println(infile.getStatus());</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;System.out.println(infile.getProgress());</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}</p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<h1>3.<span style="font-family: &#x5B8B;&#x4F53;;">&#x591A;&#x4EBA;&#x804A;&#x5929;</span></h1>
<p>MultiUserChat<span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;&#x5373;&#x591A;&#x4EBA;&#x804A;&#x5929;&#xFF0C;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x521B;&#x5EFA;&#x7FA4;&#x7EC4;&#xFF0C;&#x5E76;&#x9080;&#x8BF7;&#x5176;&#x4ED6;&#x7528;&#x6237;&#x8FDB;&#x5165;&#x7FA4;&#x7EC4;&#xFF0C;&#x6216;&#x8005;&#x5176;&#x4ED6;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x81EA;&#x7531;&#x8FDB;&#x5165;&#x7FA4;&#x7EC4;&#xFF0C;&#x5E76;&#x5728;&#x7FA4;&#x7EC4;&#x91CC;&#x804A;&#x5929;&#x3002;&#x529F;&#x80FD;&#x6709;&#x521B;&#x5EFA;&#x623F;&#x95F4;&#x3001;&#x9080;&#x8BF7;&#x3001;&#x76D1;&#x542C;&#x9080;&#x8BF7;&#x6216;&#x62D2;&#x7EDD;&#x3001;&#x6743;&#x9650;&#x66F4;&#x6539;&#x3001;&#x8EAB;&#x4EFD;&#x6539;&#x53D8;&#x7B49;&#x3002;</span></p>
<h2>3.1<span style="font-family: &#x5B8B;&#x4F53;;">&#x521B;&#x5EFA;&#x591A;&#x4EBA;&#x804A;&#x5929;&#x623F;&#x95F4;</span></h2>
<p>&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x4E24;&#x79CD;&#x591A;&#x4EBA;&#x804A;&#x5929;&#x623F;&#x95F4;&#xFF1A;&#x5373;&#x65F6;&#x623F;&#x95F4;&#x548C;&#x6C38;&#x4E45;&#x623F;&#x95F4;&#x3002;&#x5373;&#x65F6;&#x623F;&#x95F4;&#x6309;&#x7167;&#x9ED8;&#x8BA4;&#x7684;&#x8BBE;&#x7F6E;&#x7ACB;&#x9A6C;&#x751F;&#x6210;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x6240;&#x6709;&#x53C2;&#x4E0E;&#x7528;&#x6237;&#x4E0B;&#x7EBF;&#x540E;&#xFF0C;&#x8BE5;&#x623F;&#x95F4;&#x6CE8;&#x9500;&#x3002;&#x6C38;&#x4E45;&#x623F;&#x95F4;&#x662F;&#x521B;&#x5EFA;&#x8005;&#x901A;&#x8FC7;&#x81EA;&#x5DF1;&#x7684;&#x8BBE;&#x7F6E;&#x751F;&#x6210;&#xFF0C;&#x521B;&#x5EFA;&#x8005;&#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x4E0E;&#x8005;&#xFF0C;&#x5E76;&#x4E14;&#x662F;&#x8BE5;&#x623F;&#x95F4;&#x7684;<span style="font-family: Calibri;">Owner</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;</span></p>
<p>&#x8981;&#x60F3;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x623F;&#x95F4;&#xFF0C;&#x9996;&#x5148;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;<span style="font-family: Calibri;">MultiUserChat</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x5BF9;&#x8C61;&#xA0;&#xFF0C;</span><span style="font-family: Calibri;">MultiUserChat</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7C7B;&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x9700;&#x8981;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x5F53;&#x524D;&#x7528;&#x6237;&#x7684;&#x8FDE;&#x63A5;&#x548C;&#x623F;&#x95F4;&#x7684;</span><span style="font-family: Calibri;">JID</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;&#x5982;</span></p>
<p>MultiUserChat&#xA0;chatRoom&#xA0;=&#xA0;new&#xA0;MultiUserChat(conn,&#xA0;&#x201C;myGroup@conference&#xA0;.z00189374&#x201D;);</p>
<p>&#x901A;&#x8FC7;<span style="font-family: Calibri;">chatRoom</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8C03;&#x7528;</span><span style="font-family: Calibri;">create(</span>&#x201C;nickname&#x201D;)<span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x521B;&#x5EFA;&#x623F;&#x95F4;&#xFF0C;&#x5176;&#x4E2D;</span><span style="font-family: Calibri;">nickName</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E3A;&#x7528;&#x6237;&#x5728;&#x623F;&#x95F4;&#x91CC;&#x663E;&#x793A;&#x7684;&#x6635;&#x79F0;&#x3002;</span></p>
<p>&#x4E3A;&#x4E86;&#x4F7F;&#x623F;&#x95F4;&#x6210;&#x4E3A;&#x6C38;&#x4E45;&#x623F;&#x95F4;&#x5E76;&#x4E14;&#x66F4;&#x52A0;&#x7B26;&#x5408;&#x7528;&#x6237;&#x7684;&#x4E60;&#x60EF;&#xFF0C;&#x7528;&#x6237;&#x9700;&#x8981;&#x5BF9;&#x623F;&#x95F4;&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x8BBE;&#x7F6E;&#x3002;&#x7B2C;&#x4E00;&#x6B65;&#x662F;&#x83B7;&#x53D6;&#x623F;&#x95F4;&#x7684;&#x914D;&#x7F6E;&#x8868;&#x683C;&#xFF0C;&#x4EE3;&#x7801;&#x4E3A;</p>
<p>Form&#xA0;form&#xA0;=&#xA0;chatRoom.getConfigurationForm();</p>
<p>&#x518D;&#x6839;&#x636E;&#x914D;&#x7F6E;&#x8868;&#x683C;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x7528;&#x6765;&#x63D0;&#x4EA4;&#x914D;&#x7F6E;&#x7684;&#x8868;&#x683C;&#xFF0C;&#x4EE3;&#x7801;&#x4E3A;</p>
<p>Form&#xA0;submitForm&#xA0;=&#xA0;form.createAnswerForm();</p>
<p>&#x5728;&#x5BF9;<span style="font-family: Calibri;">submifForm</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8FDB;&#x884C;&#x8BBE;&#x7F6E;&#x4E00;&#x4E9B;&#x5C5E;&#x6027;&#xFF0C;&#x5C5E;&#x6027;&#x5305;&#x542B;&#x4F46;&#x4E0D;&#x9650;&#x4E8E;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#xFF1A;</span></p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x623F;&#x95F4;&#x7684;&#x540D;&#x79F0;</span></p>
<p>submitForm.setAnswer(&quot;muc#roomconfig_roomname&quot;,&#xA0;&quot;TestUserNumber&quot;);</p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x4FDD;&#x8BC1;&#x53EA;&#x6709;&#x6CE8;&#x518C;&#x7684;&#x6635;&#x79F0;&#x624D;&#x80FD;&#x8FDB;&#x5165;&#x623F;&#x95F4;</span></p>
<p>submitForm.setAnswer(&quot;x-muc#roomconfig_reservednick&quot;,true);</p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x8BBE;&#x7F6E;&#x4E3A;&#x6C38;&#x4E45;&#x623F;&#x95F4;</span></p>
<p>submitForm.setAnswer(&quot;muc#roomconfig_persistentroom&quot;,true);</p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x8BBE;&#x7F6E;&#x623F;&#x95F4;&#x4EBA;&#x6570;&#x4E0A;&#x9650;&#xFF0C;&#x6CE8;&#x610F;&#xFF0C;&#x53C2;&#x6570;&#x4E0D;&#x662F;</span><span style="font-family: &apos;Courier New&apos;;">int</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF01;&#xFF01;&#xFF01;&#xFF01;&#xFF01;</span></p>
<p>submitForm.setAnswer(&quot;muc#roomconfig_maxusers&quot;,list);</p>
<p>&#x6700;&#x540E;&#x901A;&#x8FC7;<span style="font-family: &apos;Courier New&apos;;">chatRoom</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8C03;&#x7528;</span><span style="font-family: &apos;Courier New&apos;;">sendConfigurationForm(submitForm)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x5B8C;&#x6210;&#x5BF9;&#x623F;&#x95F4;&#x7684;&#x914D;&#x7F6E;&#x3002;</span></p>
<p>&#xA0;</p>
<h2>3.2<span style="font-family: &#x5B8B;&#x4F53;;">&#x52A0;&#x5165;&#x804A;&#x5929;&#x5BA4;</span></h2>
<p>&#x4E3A;&#x4E86;&#x5728;&#x804A;&#x5929;&#x5BA4;&#x91CC;&#x63A5;&#x53D7;&#x6216;&#x53D1;&#x9001;&#x6D88;&#x606F;&#xFF0C;&#x9996;&#x5148;&#x9700;&#x8981;&#x8FDB;&#x5165;&#x804A;&#x5929;&#x5BA4;&#x3002;&#x8FDB;&#x5165;&#x623F;&#x95F4;&#x4E4B;&#x524D;&#xFF0C;&#x5148;&#x901A;&#x8FC7;&#x7528;&#x6237;&#x8FDE;&#x63A5;&#x548C;&#x623F;&#x95F4;<span style="font-family: Calibri;">JID</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;</span><span style="font-family: Calibri;">MultiUserChat</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x5BF9;&#x8C61;&#x3002;</span></p>
<p>MultiUserChat&#xA0;chatRoom1&#xA0;=&#xA0;new&#xA0;MultiUserChat(conn1,&#xA0;&#x201C;myGroup@&#xA0;conference&#xA0;.z00189374&#x201D;);</p>
<p>&#x6709;&#x4E09;&#x79CD;&#x8FDB;&#x5165;&#x623F;&#x95F4;&#x7684;&#x65B9;&#x5F0F;&#xFF1A;</p>
<p>&#x4E00;&#x3001;&#x76F4;&#x63A5;&#x52A0;&#x5165;&#x4E0D;&#x9700;&#x8981;&#x5BC6;&#x7801;&#x7684;&#x623F;&#x95F4;<span style="font-family: Calibri;">chatRoom1.join(</span>&#x201C;nickname&#x201D;);</p>
<p>&#x4E8C;&#x3001;&#x52A0;&#x5165;&#x9700;&#x8981;&#x5BC6;&#x7801;&#x7684;&#x623F;&#x95F4;<span style="font-family: Calibri;">chatRoom1.join(</span>&#x201C;nickName&#x201D;,&#x201D;password&#x201D;);</p>
<p>&#x4E09;&#x3001;&#x52A0;&#x5165;&#x9700;&#x8981;&#x5BC6;&#x7801;&#x7684;&#x623F;&#x95F4;&#xFF0C;&#x4E14;&#x540C;&#x65F6;&#x8BBE;&#x7F6E;&#x63A5;&#x53D7;&#x804A;&#x5929;&#x8BB0;&#x5F55;&#x7684;&#x6570;&#x76EE;&#xFF0C;&#x5728;&#x4E00;&#x3001;&#x4E8C;&#x4E2D;&#xFF0C;&#x6CA1;&#x6709;&#x8BBE;&#x7F6E;&#x8FD9;&#x9879;&#xFF0C;&#x63A5;&#x53D7;&#x7684;&#x6570;&#x76EE;&#x6709;&#x670D;&#x52A1;&#x5668;&#x51B3;&#x5B9A;&#x3002;</p>
<p>DiscussionHistory&#xA0;history&#xA0;=&#xA0;new&#xA0;DiscussionHistory();</p>
<p>history.setMaxStanzas(5);</p>
<p>muc2.join(&quot;testbot2&quot;,&quot;password&quot;,history,&#xA0;SmackConfiguration.getPacketReplyTimeout());</p>
<p>&#xA0;</p>
<h2>3.3&#xA0;<span style="font-family: &#x5B8B;&#x4F53;;">&#x7FA4;&#x7EC4;&#x9080;&#x8BF7;&#x53CA;&#x7FA4;&#x7EC4;&#x9080;&#x8BF7;&#x76D1;&#x542C;</span></h2>
<p>&#x5982;&#x679C;&#x4F60;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x7FA4;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x5E0C;&#x671B;&#x4F60;&#x7684;&#x67D0;&#x4E9B;&#x597D;&#x53CB;&#x4E5F;&#x52A0;&#x5165;&#x5230;&#x8FD9;&#x4E2A;&#x7FA4;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5BF9;&#x4ED6;&#x4EEC;&#x53D1;&#x9001;&#x9080;&#x8BF7;&#x5E76;&#x76D1;&#x542C;&#x7ED3;&#x679C;&#x6765;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x3002;</p>
<p>&#x9996;&#x5148;&#x52A0;&#x5165;&#x4E00;&#x4E2A;&#x623F;&#x95F4;&#xFF0C;<span style="font-family: Calibri;">muc.join(</span>&#x201C;livsun&#x201D;)<span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;&#x5E76;&#x4E14;&#x786E;&#x8BA4;&#x4F60;&#x6709;&#x8FD9;&#x4E2A;&#x623F;&#x95F4;&#x7684;&#x9080;&#x8BF7;&#x8D44;&#x683C;&#x3002;&#x7136;&#x540E;&#x901A;&#x8FC7;</span><span style="font-family: Calibri;">muc</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8C03;&#x7528;</span><span style="font-family: Calibri;">invite(user,reason)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x65B9;&#x6CD5;&#xFF0C;&#x5176;&#x4E2D;</span><span style="font-family: Calibri;">user</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x88AB;&#x9080;&#x8BF7;&#x4EBA;&#x7684;</span><span style="font-family: Calibri;">JID</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;</span><span style="font-family: Calibri;">reason</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x9080;&#x8BF7;&#x539F;&#x56E0;&#x3002;&#x4E3A;&#x4E86;&#x77E5;&#x9053;&#x9080;&#x8BF7;&#x7ED3;&#x679C;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x80FD;&#x83B7;&#x53D6;&#x5BF9;&#x9762;&#x62D2;&#x7EDD;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x5728;&#x53D1;&#x51FA;&#x9080;&#x8BF7;&#x4E4B;&#x524D;&#xFF0C;&#x9700;&#x8981;&#x5BF9;</span><span style="font-family: Calibri;">multiuserChat</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5BF9;&#x8C61;&#x6CE8;&#x518C;&#x4E00;&#x4E2A;&#x76D1;&#x542C;&#x5668;</span>muc.addInvitationRejectionListener(new&#xA0;InvitationRejectionListener()&#xA0;)<span style="font-family: &#x5B8B;&#x4F53;;">&#xFF1B;</span></p>
<p>&#x4E3A;&#x4E86;&#x83B7;&#x53D6;&#x6765;&#x81EA;&#x5176;&#x4ED6;&#x4EBA;&#x7684;&#x7FA4;&#x7EC4;&#x9080;&#x8BF7;&#xFF0C;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x901A;&#x8FC7;&#x81EA;&#x5DF1;&#x7684;&#x8FDE;&#x63A5;&#x5BF9;<span style="font-family: Calibri;">MultiUserChat</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6CE8;&#x518C;&#x4E00;&#x4E2A;&#x76D1;&#x542C;&#x5668;&#x3002;&#x5982;</span><span style="font-family: Calibri;">MultiUserChat.</span>addInvitationListener(conn1,&#xA0;new&#xA0;InvitationListener()&#xA0;)<span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;</span></p>
<p>&#x4E0B;&#x9762;&#x770B;&#x4E00;&#x4E2A;<span style="font-family: Calibri;">livsun</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5BF9;</span><span style="font-family: Calibri;">livsun1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x53D1;&#x8D77;&#x9080;&#x8BF7;&#xFF0C;</span><span style="font-family: Calibri;">livsun1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x62D2;&#x7EDD;&#x5BF9;&#x4F8B;&#x5B50;&#xFF1A;</span></p>
<p>MultiUserChat&#xA0;muc&#xA0;=&#xA0;new&#xA0;MultiUserChat(conn,&#xA0;&#x201C;maGroup@conference.z00189374&#x201D;);</p>
<p>&#xA0;muc.join(&quot;livsun&quot;);</p>
<p>muc.addInvitationRejectionListener(new&#xA0;InvitationRejectionListener()&#xA0;{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;void&#xA0;invitationDeclined(String&#xA0;invitee,&#xA0;String&#xA0;reason)&#xA0;{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;&#x88AB;&#x62D2;&#x7EDD;&#x4E86;</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;});</p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x53D1;&#x51FA;&#x9080;&#x8BF7;</span></p>
<p>&#xA0;muc.invite(&quot;livsun1@z00189374/Smack&quot;,&#xA0;&quot;For&#xA0;Dota&quot;);</p>
<p>&#xA0;</p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x4E0B;&#x9762;&#x662F;</span><span style="font-family: Calibri;">livsun1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x5904;&#x7406;</span></p>
<p>MultiUserChat.addInvitationListener(conn1,&#xA0;new&#xA0;InvitationListener()&#xA0;{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;void&#xA0;invitationReceived(Connection&#xA0;conn,&#xA0;String&#xA0;room,&#xA0;String&#xA0;inviter,&#xA0;String&#xA0;reason,&#xA0;String&#xA0;password)&#xA0;{</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;&#x5BF9;&#x8BF7;&#x6C42;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x62D2;&#x7EDD;&#x4E86;</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;MultiUserChat.decline(conn,&#xA0;room,&#xA0;inviter,&#xA0;&quot;I&apos;m&#xA0;working&#xA0;delay&quot;);</p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x63A5;&#x53D7;&#x5E76;&#x52A0;&#x5165;</span></p>
<p>//MultiUserChat&#xA0;muc1&#xA0;=&#xA0;new&#xA0;MultiUserChat(conn,&#xA0;room);</p>
<p>//muc1.join(&#x201C;livsun1&#x201D;);</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;});</p>
<p>&#xA0;</p>
<h2>3.4&#xA0;<span style="font-family: &#x5B8B;&#x4F53;;">&#x5728;&#x7FA4;&#x7EC4;&#x4E2D;&#x5F00;&#x59CB;&#x4E00;&#x4E2A;&#x5355;&#x4EBA;&#x804A;&#x5929;</span></h2>
<p>&#x5728;&#x7FA4;&#x7EC4;&#x5217;&#x8868;&#x4E2D;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x60F3;&#x5BF9;&#x67D0;&#x4E2A;&#x4EBA;&#x53D1;&#x8D77;&#x5355;&#x72EC;&#x5BF9;&#x8BDD;&#xFF0C;&#x8FD9;&#x65F6;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x65B9;&#x6CD5;&#x5B9E;&#x73B0;&#xFF1A;</p>
<p class="pre">Chat&#xA0;chat&#xA0;=&#xA0;muc.createPrivateChat(&quot;myGroup@conference.z00189374/livsun1&quot;);</p>
<p>&#xA0;&#xA0;chat.sendMessage(&quot;Hello&#xA0;there&quot;);</p>
<p>&#x4E0D;&#x8FC7;&#x8FD9;&#x6837;<span style="font-family: Calibri;">livsun1</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6536;&#x5230;&#x7684;&#x6D88;&#x606F;&#x5E76;&#x4E0D;&#x662F;&#x6765;&#x81EA;&#x4E8E;</span><span style="font-family: Calibri;">livsun</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;&#x800C;&#x662F;&#x6765;&#x81EA;</span>myGroup@conference.z00189374</p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<h2>3.5<span style="font-family: &#x5B8B;&#x4F53;;">&#x66F4;&#x6539;&#x623F;&#x95F4;&#x6210;&#x5458;&#x6743;&#x9650;</span></h2>
<p>&#x4E00;&#x4E2A;&#x5178;&#x578B;&#x7684;&#x7FA4;&#x7EC4;&#x5177;&#x6709;&#x4E09;&#x79CD;&#x8EAB;&#x4EFD;&#x7684;&#x4EBA;&#xFF1A;&#x521B;&#x5EFA;&#x8005;&#x3001;&#x7BA1;&#x7406;&#x5458;&#x548C;&#x6210;&#x5458;&#x3002;&#x623F;&#x95F4;&#x521B;&#x5EFA;&#x8005;&#x53EF;&#x4EE5;&#x6539;&#x53D8;&#x623F;&#x95F4;&#x914D;&#x7F6E;&#x3001;&#x6388;&#x4E88;&#x7528;&#x6237;&#x6240;&#x6709;&#x6743;&#x548C;&#x7BA1;&#x7406;&#x6743;&#x9650;&#x4EE5;&#x53CA;&#x6BC1;&#x6389;&#x6B64;&#x623F;&#x95F4;&#x3002;&#x623F;&#x95F4;&#x7BA1;&#x7406;&#x5458;&#x53EF;&#x4EE5;&#x7981;&#x6B62;&#x6216;&#x6388;&#x4E88;&#x7528;&#x6237;&#x6743;&#x9650;&#x548C;&#x4E3B;&#x6301;&#x8005;&#x6743;&#x9650;&#x3002;&#x623F;&#x95F4;&#x6210;&#x5458;&#x4EC5;&#x80FD;&#x5141;&#x8BB8;&#x7528;&#x6237;&#x52A0;&#x5165;&#x623F;&#x95F4;&#x3002;&#x8FD9;&#x91CC;&#x7528;&#x5230;&#x7684;&#x65B9;&#x6CD5;&#x90FD;&#x662F;<span style="font-family: Calibri;">MultiUserChat</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5177;&#x4F53;&#x53EF;&#x4EE5;&#x53BB;&#x770B;</span><span style="font-family: Calibri;">Smack</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;</span><span style="font-family: Calibri;">API</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6587;&#x6863;&#x3002;</span></p>
<p>&#x8FD8;&#x53EF;&#x4EE5;&#x5BF9;&#x623F;&#x95F4;&#x5176;&#x4ED6;&#x6210;&#x5458;&#x6216;&#x81EA;&#x5DF1;&#x7684;&#x6743;&#x9650;&#x6539;&#x53D8;&#x8FDB;&#x884C;&#x76D1;&#x542C;&#xFF0C;&#x65B9;&#x6CD5;&#x5206;&#x522B;&#x4E3A;<a href="file:///Applications/WizNote.app/Contents/Resources/files/editor/index.html#addParticipantStatusListener%28org.jivesoftware.smackx.muc.ParticipantStatusListener%29">addParticipantStatusListener</a>(<a title="interface in org.jivesoftware.smackx.muc" href="http://www.igniterealtime.org/builds/smack/docs/3.1.0/javadoc/org/jivesoftware/smackx/muc/ParticipantStatusListener.html">ParticipantStatusListener</a>&#xA0;listener)&#x548C;<a href="file:///Applications/WizNote.app/Contents/Resources/files/editor/index.html#addUserStatusListener%28org.jivesoftware.smackx.muc.UserStatusListener%29">addUserStatusListener</a>(<a title="interface in org.jivesoftware.smackx.muc" href="http://www.igniterealtime.org/builds/smack/docs/3.1.0/javadoc/org/jivesoftware/smackx/muc/UserStatusListener.html">UserStatusListener</a>&#xA0;listener)</p>
<p>&#xA0;</p>
<h2>3.6<span style="font-family: &#x5B8B;&#x4F53;;">&#x83B7;&#x53D6;&#x81EA;&#x5DF1;&#x66FE;&#x7ECF;&#x52A0;&#x5165;&#x7684;&#x623F;&#x95F4;</span></h2>
<p>MultiUserChat<span style="font-family: &#x5B8B;&#x4F53;;">&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x65B9;&#x6CD5;&#x83B7;&#x53D6;&#x81EA;&#x5DF1;&#x66FE;&#x7ECF;&#x52A0;&#x5165;&#x7684;&#x623F;&#x95F4;&#xFF0C;&#x5B83;&#x7684;</span><span style="font-family: Calibri;">getJoinedRooms</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x53EA;&#x80FD;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x597D;&#x53CB;&#x5F53;&#x524D;&#x6B63;&#x5728;&#x52A0;&#x5165;&#x7684;&#x623F;&#x95F4;&#x3002;&#x800C;&#x5F53;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x767B;&#x9646;&#x65F6;&#xFF0C;&#x7528;&#x6237;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x81EA;&#x5DF1;&#x52A0;&#x5165;&#x8FC7;&#x7684;&#x623F;&#x95F4;&#x5217;&#x8868;&#xFF0C;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x7528;&#x5230;&#x6536;&#x85CF;&#x5939;</span><span style="font-family: Calibri;">Bookmarks</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;</span></p>
<p>&#xA0;</p>
<h3>3.6.1<span style="font-family: &#x5B8B;&#x4F53;;">&#x4FDD;&#x5B58;&#x623F;&#x95F4;&#x4FE1;&#x606F;</span></h3>
<p>&#x9996;&#x5148;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;<span style="font-family: Calibri;">Bookmarks</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x5BF9;&#x8C61;&#xFF0C;</span><span style="font-family: Calibri;">BookeMarks&#xA0;bm&#xA0;=&#xA0;new&#xA0;BookeMarks()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;&#x7136;&#x540E;&#x521B;&#x5EFA;</span><span style="font-family: Calibri;">BookmarkedConference</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5BF9;&#x8C61;</span><span style="font-family: Calibri;">bmConference</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x4FDD;&#x5B58;&#x7FA4;&#x7EC4;&#x4FE1;&#x606F;&#x3002;</span></p>
<p>&#x901A;&#x8FC7;<span style="font-family: Calibri;">bm</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8C03;&#x7528;</span><a href="file:///Applications/WizNote.app/Contents/Resources/files/editor/index.html#addBookmarkedConference%28org.jivesoftware.smackx.bookmark.BookmarkedConference%29">addBookmarkedConference</a>(<a title="class in org.jivesoftware.smackx.bookmark" href="http://www.igniterealtime.org/builds/smack/docs/3.1.0/javadoc/org/jivesoftware/smackx/bookmark/BookmarkedConference.html">BookmarkedConference</a>&#xA0;bookmarkedConference)&#x65B9;&#x6CD5;&#xFF0C;&#x6765;&#x8BB2;&#x4E00;&#x4E2A;<span style="font-family: Calibri;">BookmarkedConference</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5BF9;&#x8C61;&#x52A0;&#x5165;</span><span style="font-family: Calibri;">Bookmarks</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E2D;&#x3002;</span></p>
<p>&#x6700;&#x540E;&#x8981;&#x628A;<span style="font-family: Calibri;">Bookmarks</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x4FE1;&#x606F;&#x4FDD;&#x5B58;&#x5230;&#x79C1;&#x4EBA;&#x4E13;&#x6709;&#x6570;&#x636E;&#x4E2D;&#x3002;&#x5148;&#x521B;&#x5EFA;</span><span style="font-family: Calibri;">PrivateDataManager</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;</span><span style="font-family: Calibri;">pdmanager</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;&#x901A;&#x8FC7;</span><span style="font-family: Calibri;">pdmanager</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8C03;&#x7528;&#x65B9;&#x6CD5;</span><span style="font-family: Calibri;">setPrivateData(bm)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x5C06;&#x6570;&#x636E;&#x4FDD;&#x5B58;&#x5230;&#x670D;&#x52A1;&#x5668;&#x3002;</span></p>
<p>&#x5177;&#x4F53;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x521B;&#x5EFA;&#x6536;&#x85CF;&#x5939;&#x5BF9;&#x8C61;</span></p>
<p>Bookmarks&#xA0;bookmarks&#xA0;=&#xA0;new&#xA0;Bookmarks();</p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x521B;&#x5EFA;&#x804A;&#x5929;&#x7FA4;&#x7EC4;&#x6536;&#x85CF;</span><span style="font-family: &apos;Courier New&apos;;">,</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x53C2;&#x6570;&#x5206;&#x522B;&#x4E3A;&#x623F;&#x95F4;&#x7684;&#x540D;&#x5B57;&#xFF0C;</span><span style="font-family: &apos;Courier New&apos;;">JID</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;&#x662F;&#x5426;&#x81EA;&#x52A8;&#x8FDB;&#x5165;&#x623F;&#x95F4;&#xFF0C;&#x7528;&#x6237;&#x6635;&#x79F0;&#xFF0C;&#x5BC6;&#x7801;</span></p>
<p>BookmarkedConference&#xA0;conference1&#xA0;=&#xA0;new&#xA0;BookMarkMain(&quot;groupName&quot;,&quot;myGroup@conference.z00189374&quot;,true,&quot;nickname&quot;,null);</p>
<p>bookmarks.addBookmarkedConference(conference1);</p>
<p>PrivateDataManager&#xA0;manager&#xA0;=&#xA0;new&#xA0;PrivateDataManager(conn);</p>
<p>manager.setPrivateData(bookmarks);</p>
<p>&#xA0;</p>
<h3>3.6.2<span style="font-family: &#x5B8B;&#x4F53;;">&#x83B7;&#x53D6;&#x623F;&#x95F4;&#x4FE1;&#x606F;</span></h3>
<p>&#x5F53;&#x7528;&#x6237;&#x767B;&#x5F55;&#x65F6;&#xFF0C;&#x7528;&#x6237;&#x53BB;<span style="font-family: Calibri;">privateData</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x83B7;&#x53D6;&#x81EA;&#x5DF1;&#x7684;&#x623F;&#x95F4;&#x4FE1;&#x606F;&#x3002;&#x7528;&#x6237;&#x9700;&#x8981;&#x63D0;&#x4F9B;</span><span style="font-family: Calibri;">Bookmarks</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x89E3;&#x6790;&#x65B9;&#x6CD5;&#x6765;&#x6B63;&#x786E;&#x83B7;&#x53D6;&#x4FDD;&#x5B58;&#x5728;</span><span style="font-family: Calibri;">PrivateData</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E2D;&#x7684;</span><span style="font-family: Calibri;">Bookmarks</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4FE1;&#x606F;&#x3002;&#x5177;&#x4F53;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;</span></p>
<p>&#xA0;</p>
<p>Bookmarks&#xA0;bm&#xA0;=&#xA0;new&#xA0;Bookmarks();</p>
<p>PrivateDataManager&#xA0;manager&#xA0;=&#xA0;new&#xA0;PrivateDataManager(conn);</p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x63D0;&#x4F9B;&#x5BF9;</span><span style="font-family: &apos;Courier New&apos;;">Bookmarks</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;</span><span style="font-family: &apos;Courier New&apos;;">IQ</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5305;&#x7684;&#x89E3;&#x6790;&#x65B9;&#x6CD5;</span></p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;manager.addPrivateDataProvider(bm.getElementName(),&#xA0;</p>
<p>bm.getNamespace(),&#xA0;new&#xA0;Bookmarks.Provider());</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;//<span style="font-family: &#x5B8B;&#x4F53;;">&#x83B7;&#x53D6;</span><span style="font-family: &apos;Courier New&apos;;">Bookmarks</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4FE1;&#x606F;</span></p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;bm&#xA0;=&#xA0;(Bookmarks)manager.getPrivateData(bm.getElementName(),</p>
<p>bm.getNamespace());</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;//<span style="font-family: &#x5B8B;&#x4F53;;">&#x83B7;&#x53D6;</span><span style="font-family: &apos;Courier New&apos;;">Bookmarks</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E2D;&#x7FA4;&#x7EC4;&#x7684;&#x4FE1;&#x606F;&#x3002;</span></p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;Collection&lt;BookmarkedConference&gt;&#xA0;c&#xA0;=&#xA0;bm.getBookmarkedConferences();</p>
<p>&#xA0;</p>
<h1>4.<span style="font-family: &#x5B8B;&#x4F53;;">&#x8054;&#x7CFB;&#x4EBA;</span></h1>
<p>&#x6BCF;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x90FD;&#x6709;&#x4E00;&#x4E2A;<span style="font-family: &apos;Courier New&apos;;">Roster</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5217;&#x8868;&#xFF0C;&#x5305;&#x542B;&#x591A;&#x4E2A;</span><span style="font-family: &apos;Courier New&apos;;">RosterEntry</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;</span></p>
<p>&#x5728;<span style="font-family: &apos;Courier New&apos;;">roster</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E2D;&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x7528;&#x4E00;&#x4E2A;</span><span style="font-family: &apos;Courier New&apos;;">RosterEntry</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8868;&#x793A;&#xFF0C;&#x5B83;&#x5305;&#x62EC;&#xFF1A;</span></p>
<p>&#x4E00;&#x4E2A;<span style="font-family: &apos;Courier New&apos;;">XMPP</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5730;&#x5740;</span><span style="font-family: &apos;Courier New&apos;;">(</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4F8B;&#x5982;&#xA0;</span><a href="mailto:livsun@z00189374">livsun@z00189374</a>)<span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;</span></p>
<p>&#x4E00;&#x4E2A;&#x60A8;&#x5206;&#x914D;&#x7ED9;&#x7528;&#x6237;&#x7684;&#x6635;&#x79F0;(<span style="font-family: &#x5B8B;&#x4F53;;">&#x4F8B;&#x5982;&#xA0;</span><span style="font-family: &apos;Courier New&apos;;">&quot;</span>2b&quot;)<span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;&#xA0;</span></p>
<p>&#x767B;&#x9646;&#x6240;&#x5C5E;&#x7684;<span style="font-family: &apos;Courier New&apos;;">roster</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7EC4;&#x5217;&#x8868;&#x3002;&#x5982;&#x679C;</span><span style="font-family: &apos;Courier New&apos;;">roster</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x767B;&#x9646;&#x4E0D;&#x5C5E;&#x4E8E;&#x4EFB;&#x4F55;&#x7EC4;&#xFF0C;&#x5B83;&#x5C06;&#x88AB;&#x79F0;&#x4E3A;</span><span style="font-family: &apos;Courier New&apos;;">&#x201C;unfiled&#xA0;entry&#x201D;</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;&#xA0;</span>&#x5728;<span style="font-family: &apos;Courier New&apos;;">openfire</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E2D;&#x4E00;&#x4E2A;</span><span style="font-family: &apos;Courier New&apos;;">RosterEntry</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x5C5E;&#x4E8E;&#x591A;&#x4E2A;&#x5206;&#x7EC4;&#x3002;</span></p>
<h2>4.1<span style="font-family: &#x5B8B;&#x4F53;;">&#x83B7;&#x53D6;&#x8054;&#x7CFB;&#x4EBA;</span></h2>
<p>&#x5F53;&#x7528;&#x6237;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x8FDE;&#x63A5;&#x767B;&#x5F55;&#x670D;&#x52A1;&#x5668;&#x540E;&#xFF0C;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x83B7;&#x53D6;&#x81EA;&#x5DF1;&#x7684;<span style="font-family: Calibri;">Roster</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5217;&#x8868;&#x3002;</span></p>
<p>Roster&#xA0;roster&#xA0;=&#xA0;conn.getRoster();&#xA0;</p>
<p>&#x83B7;&#x53D6;<span style="font-family: Calibri;">Roster</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x540E;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528;</span><span style="font-family: Calibri;">roster.getEntries()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x65B9;&#x6CD5;&#x6765;&#x83B7;&#x53D6;&#x6240;&#x6709;</span><span style="font-family: Calibri;">RosterEntry</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5BF9;&#x8C61;&#xFF0C;&#x8FD4;&#x56DE;&#x7C7B;&#x578B;&#x4E3A;</span><span style="font-family: Calibri;">Collection&lt;RosterEntry&gt;</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;</span></p>
<p>Collection&lt;RosterEntry&gt;&#xA0;rosterentrys&#xA0;=&#xA0;roster.getEntries();</p>
<p>&#x5982;&#x679C;&#x60F3;&#x83B7;&#x5F97;&#x5206;&#x7EC4;&#x4FE1;&#x606F;&#xFF0C;&#x9700;&#x8981;&#x8C03;&#x7528;<span style="font-family: Calibri;">roster.getGroups(),&#xA0;</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x662F;&#x4E00;&#x4E2A;</span><span style="font-family: Calibri;">Collection&lt;RosterGroup&gt;</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;&#x53EF;&#x4EE5;&#x5728;&#x901A;&#x8FC7;</span><span style="font-family: Calibri;">rosterGroup.getEntries()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x83B7;&#x53D6;&#x6BCF;&#x4E2A;&#x5206;&#x7EC4;&#x7684;&#x6210;&#x5458;&#x3002;</span></p>
<p>&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x6210;&#x5458;&#x7684;&#x72B6;&#x6001;&#x4FE1;&#x606F;&#xFF0C;&#x5982;&#x662F;&#x5426;&#x5728;&#x7EBF;&#xFF0C;&#x7B7E;&#x540D;&#x7B49;&#xFF0C;&#x53EF;&#x901A;&#x8FC7;<span style="font-family: Calibri;">roster.gerPresence(RosterEntry)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x83B7;&#x53D6;&#x3002;</span></p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<h2>4.2<span style="font-family: &#x5B8B;&#x4F53;;">&#x7BA1;&#x7406;&#x597D;&#x53CB;</span></h2>
<p>&#x7528;&#x6237;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x5176;&#x4ED6;&#x7528;&#x6237;&#x5230;&#x81EA;&#x5DF1;&#x7684;<span style="font-family: Calibri;">Roster</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E2D;&#xFF0C;&#x5E76;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x8FD9;&#x4E9B;&#x7528;&#x6237;&#x7684;&#x72B6;&#x6001;&#x66F4;&#x65B0;&#x3002;</span><span style="font-family: Calibri;">Smack</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x79CD;&#x8BA2;&#x9605;&#x7684;</span><span style="font-family: Calibri;">Presence</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x83B7;&#x53D6;&#x72B6;&#x6001;&#xFF0C;&#x8FD9;&#x6837;&#x786E;&#x4FDD;&#x7528;&#x6237;&#x9690;&#x79C1;&#xFF0C;&#x56E0;&#x4E3A;&#x53EA;&#x6709;&#x5141;&#x8BB8;&#x8BA2;&#x9605;&#x624D;&#x80FD;&#x83B7;&#x53D6;&#x72B6;&#x6001;&#x3002;</span></p>
<p>&#x5BF9;&#x4E8E;&#x8BA2;&#x9605;&#x8BF7;&#x6C42;&#xFF0C;&#x7528;&#x6237;&#x6709;&#x4E09;&#x79CD;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#xFF1A;&#x63A5;&#x53D7;&#x6240;&#x6709;&#x3001;&#x62D2;&#x7EDD;&#x6240;&#x6709;&#x548C;&#x624B;&#x52A8;&#x5904;&#x7406;&#x3002;&#x8FD9;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x901A;&#x8FC7;Roster.setSubscriptionMode(int&#xA0;subscriptionMode)&#x65B9;&#x6CD5;&#x6765;&#x8BBE;&#x7F6E;&#x3002;</p>
<p>&#x6DFB;&#x52A0;&#x597D;&#x53CB;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x4E92;&#x76F8;&#x53D1;&#x9001;&#x72B6;&#x6001;&#x8BA2;&#x9605;&#x6D88;&#x606F;&#x7684;&#x8FC7;&#x7A0B;&#x3002;&#x901A;&#x8FC7;&#x8C03;&#x7528;<span style="font-family: Calibri;">roster.createEntry(JID,nickname,group)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x5C06;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x6DFB;&#x52A0;&#x5230;&#x81EA;&#x5DF1;&#x7684;</span><span style="font-family: Calibri;">roster</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E2D;&#xFF0C;&#x5E76;&#x5411;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x8BA2;&#x9605;</span><span style="font-family: Calibri;">presence</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x8BF7;&#x6C42;&#x3002;</span></p>
<p>&#xA0;</p>
<p>&#x5220;&#x9664;&#x597D;&#x53CB;&#x53EA;&#x9700;<span style="font-family: Calibri;">roster.removeEntry(RosterEntry)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5C31;&#x53EF;&#x4EE5;&#x5C06;&#x7528;&#x6237;&#x4ECE;&#x81EA;&#x5DF1;&#x7684;</span><span style="font-family: Calibri;">roster</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4E2D;&#x5220;&#x9664;&#x3002;</span></p>
<p>&#xA0;</p>
<p>&#x5982;&#x679C;&#x7528;&#x6237;&#x60F3;&#x628A;&#x67D0;&#x4F4D;&#x597D;&#x53CB;&#x4ECE;&#x4E00;&#x4E2A;&#x7FA4;&#x7EC4;&#x79FB;&#x52A8;&#x5230;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x7FA4;&#x7EC4;&#x91CC;&#xFF0C;&#x9700;&#x8981;&#x7528;&#x5230;<span style="font-family: Calibri;">RosterGroup</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;</span><span style="font-family: Calibri;">removeEntry()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x548C;</span><span style="font-family: Calibri;">addEntry()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x65B9;&#x6CD5;&#x3002;&#x5047;&#x8BBE;&#x5F53;&#x524D;&#x7FA4;&#x7EC4;&#x540D;&#x79F0;&#x4E3A;</span><span style="font-family: Calibri;">groupNow</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;&#x5373;&#x5C06;&#x79FB;&#x5165;&#x7684;&#x7FA4;&#x7EC4;&#x540D;&#x79F0;&#x4E3A;</span><span style="font-family: Calibri;">groupTo</span><span style="font-family: &#x5B8B;&#x4F53;;">&#xFF0C;&#x5219;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;</span></p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x5047;&#x8BBE;&#x88AB;&#x79FB;&#x52A8;&#x7684;&#x6210;&#x5458;&#x4E3A;&#x4E00;&#x4E2A;</span><span style="font-family: Calibri;">RosterEntry</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5BF9;&#x8C61;</span><span style="font-family: Calibri;">rosterEntryMove</span></p>
<p>RosterGroup&#xA0;&#xA0;gourpNow&#xA0;=&#xA0;roster.getGroup(&#x201C;groupNow&#x201D;);</p>
<p>RosterGroup&#xA0;&#xA0;gourpTo&#xA0;&#xA0;=&#xA0;roster.getGroup(&#x201C;groupTo&#x201D;);</p>
<p>groupNow.removeEntry(rosterEntryMove);</p>
<p>groupTo.addEntry(rosterEntryMove);</p>
<h2>4.2<span style="font-family: &#x5B8B;&#x4F53;;">&#x72B6;&#x6001;&#x4FEE;&#x6539;</span></h2>
<p>Presence<span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x7528;&#x6765;&#x7BA1;&#x7406;&#x7528;&#x6237;&#x7684;&#x5728;&#x7EBF;&#x72B6;&#x6001;&#xFF0C;&#x5B83;&#x6709;&#x5728;&#x7EBF;&#x548C;&#x4E0D;&#x5728;&#x7EBF;&#x4E24;&#x79CD;&#x72B6;&#x6001;&#x3002;&#x5982;&#x679C;&#x5728;&#x7EBF;&#x53C8;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x5F88;&#x591A;&#x5176;&#x4ED6;&#x4FE1;&#x606F;&#xFF0C;&#x5982;&#x5FD9;&#x788C;&#x3001;&#x79BB;&#x5F00;&#x7B49;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x7B7E;&#x540D;&#x3002;</span></p>
<p>&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x53D1;&#x9001;<span style="font-family: Calibri;">Presence</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5305;&#x6765;&#x6539;&#x53D8;&#x81EA;&#x5DF1;&#x7684;&#x72B6;&#x6001;&#x3002;&#x9996;&#x5148;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;</span><span style="font-family: Calibri;">Presence</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5BF9;&#x8C61;&#x3002;</span></p>
<p>Presence&#xA0;presence&#xA0;=&#xA0;new&#xA0;Presence(Presence.type.available);</p>
<p>presence.setStatus(&#x201C;&#x5403;&#x996D;&#x53BB;&#x201D;);</p>
<p>presence.setMode(&#x201C;away&#x201D;);</p>
<p>conn.sendPacket(presence);</p>
<p>&#x8FD9;&#x91CC;&#x7528;&#x6237;&#x53D1;&#x9001;&#x4E86;&#x4E00;&#x4E2A;<span style="font-family: Calibri;">Presence</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5305;&#xFF0C;&#x66F4;&#x65B0;&#x81EA;&#x5DF1;&#x72B6;&#x6001;&#x4E3A;&#x79BB;&#x5F00;&#xFF0C;&#x4E14;&#x53D1;&#x8868;&#x5373;&#x65F6;&#x5FC3;&#x60C5;&#x4E3A;&#x201C;&#x5403;&#x996D;&#x53BB;&#x201D;&#x3002;</span><span style="font-family: Calibri;">.</span></p>
<h2>4.3<span style="font-family: &#x5B8B;&#x4F53;;">&#x9690;&#x79C1;&#x8BBE;&#x7F6E;&#x4E0E;&#x9ED1;&#x540D;&#x5355;&#x7684;&#x5B9E;&#x73B0;</span></h2>
<p>Privacy<span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x7BA1;&#x7406;&#x5176;&#x4ED6;&#x7528;&#x6237;&#x4E0E;&#x81EA;&#x5DF1;&#x901A;&#x4FE1;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x5B83;&#x662F;&#x7531;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#xFF0C;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x3001;&#x4FEE;&#x6539;&#x6216;&#x5220;&#x9664;&#x7684;&#xFF0C;&#x4FDD;&#x5B58;&#x5728;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x7684;&#x9690;&#x79C1;&#x8BBE;&#x7F6E;&#x3002;&#x5B83;&#x57FA;&#x4E8E;&#x4E09;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x8303;&#x56F4;</span><span style="font-family: Calibri;">JID</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3001;</span><span style="font-family: Calibri;">Group</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x548C;&#x7B7E;&#x540D;&#x7C7B;&#x578B;&#x6765;&#x7BA1;&#x7406;&#x9690;&#x79C1;&#x3002;&#x5176;&#x4E2D;&#x8BBE;&#x7F6E;&#x5305;&#x542B;&#x6D88;&#x606F;&#x3001;&#x4E0A;&#x7EBF;&#x901A;&#x77E5;&#x3001;</span><span style="font-family: Calibri;">IQ</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5305;&#x6216;&#x6240;&#x6709;&#x901A;&#x4FE1;&#x3002;&#x8981;&#x5B9E;&#x73B0;&#x9690;&#x79C1;&#x7BA1;&#x7406;&#x9996;&#x5148;&#x9700;&#x8981;&#x4E86;&#x89E3;&#x4ED6;&#x7684;&#x4E09;&#x4E2A;</span><span style="font-family: Calibri;">API</span></p>
<p>PrivacyListManager:&#xA0;<span style="font-family: &#x5B8B;&#x4F53;;">&#x8FD9;&#x662F;&#x91CD;&#x65B0;&#x83B7;&#x5F97;&#x5E76;&#x5904;&#x7406;&#x670D;&#x52A1;&#x5668;&#x9690;&#x79C1;&#x5217;&#x8868;&#x7684;&#x4E3B;</span><span style="font-family: Calibri;">API</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7C7B;&#x3002;</span></p>
<p>PrivacyList:&#xA0;<span style="font-family: &#x5B8B;&#x4F53;;">&#x4EE3;&#x8868;&#x4E00;&#x4E2A;&#x9690;&#x79C1;&#x5217;&#x8868;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x540D;&#x5B57;&#xFF0C;&#x4E00;&#x7EC4;&#x9690;&#x79C1;&#x9879;&#x76EE;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x53EF;&#x89C1;&#x6216;&#x4E0D;&#x53EF;&#x89C1;&#x5217;&#x8868;</span>&#x3002;PrivacyItem:<span style="font-family: &#x5B8B;&#x4F53;;">&#x963B;&#x6321;&#x6216;&#x5141;&#x8BB8;&#x9690;&#x79C1;&#x7684;&#x67D0;&#x4E2A;&#x65B9;&#x9762;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5141;&#x8BB8;&#x6211;&#x7684;&#x7684;&#x670B;&#x53CB;&#x770B;&#x5230;&#x6211;&#x4EEC;&#x7684;&#x51FA;&#x5E2D;&#x72B6;&#x6001;&#x3002;</span></p>
<p>&#xA0;</p>
<p>&#x9996;&#x5148;&#x8981;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x83B7;&#x53D6;&#x7528;&#x6237;&#x7684;<span style="font-family: Calibri;">PrivacyListManager</span></p>
<p>PrivacyListManager&#xA0;plm&#xA0;=&#xA0;PrivacyListManager.getInstanceFor(conn);</p>
<p>&#x518D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x9690;&#x79C1;&#x5217;&#x8868;</p>
<p>List&lt;PrivacyItem&gt;&#xA0;privacyItems&#xA0;=&#xA0;new&#xA0;ArrayList&lt;PrivacyItem&gt;();</p>
<p>&#x7136;&#x540E;&#x5411;&#x8FD9;&#x4E2A;&#x5217;&#x8868;&#x4E2D;&#x6DFB;&#x52A0;&#x9690;&#x79C1;&#x8BBE;&#x7F6E;</p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x5728;&#x7EBF;&#x5BF9;&#x5176;&#x9690;&#x8EAB;</span></p>
<p>PrivacyItem&#xA0;item&#xA0;=&#xA0;new&#xA0;PrivacyItem(&#x201C;jid&#x201D;,&#xA0;false,&#xA0;1);</p>
<p>item.setValue(userJID);</p>
<p>item.setFilterPresenceout(true);</p>
<p>privacyItems.add(item);</p>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#x6700;&#x540E;&#x8981;&#x5C06;&#x8FD9;&#x4E2A;&#x9690;&#x79C1;&#x5217;&#x8868;&#x521B;&#x5EFA;&#x5230;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#xFF0C;&#x5E76;&#x8BBE;&#x7F6E;&#x4E3A;&#x6FC0;&#x6D3B;&#x72B6;&#x6001;&#x3002;</p>
<p>plm.createPrivacyList(&#x201C;myList&#x201D;,&#xA0;privacyItems);</p>
<p>plm.setActiveListName(&#x201C;myList&#x201D;);</p>
<p>&#xA0;</p>
<p>&#x9ED1;&#x540D;&#x5355;&#x5B9E;&#x73B0;</p>
<p>PrivacyItem&#xA0;item1&#xA0;=&#xA0;new&#xA0;PrivacyItem(&#x201C;group&#x201D;,&#xA0;false,&#xA0;1);</p>
<p>item1.setValue(&#x201C;blacklist&#x201D;);</p>
<p>item1.setMessage(true);</p>
<p>privacyItems.add(item1);</p>
<p>&#x5176;&#x4ED6;&#x540C;<span style="font-family: Calibri;">JID</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x9690;&#x79C1;&#x8BBE;&#x7F6E;&#x4E00;&#x6837;&#x3002;</span></p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<h1>5.<span style="font-family: &#x5B8B;&#x4F53;;">&#x7528;&#x6237;&#x4FE1;&#x606F;&#x7BA1;&#x7406;</span></h1>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#x7528;&#x6237;&#x4FE1;&#x606F;&#x5305;&#x542B;&#x7528;&#x6237;&#x7684;&#x59D3;&#x540D;&#x3001;&#x6635;&#x79F0;&#x3001;&#x4F4F;&#x5740;&#x3001;&#x7535;&#x8BDD;&#x3001;&#x5934;&#x50CF;&#x548C;&#x5BC6;&#x7801;&#x7B49;&#x3002;</p>
<h2>5.1&#xA0;<span style="font-family: &#x5B8B;&#x4F53;;">&#x7528;&#x6237;&#x4FE1;&#x606F;</span></h2>
<p>VCard<span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x7528;&#x6765;&#x7BA1;&#x7406;&#x7528;&#x6237;&#x4FE1;&#x606F;&#x7684;&#x7C7B;&#x3002;&#x4E3A;&#x4E86;&#x83B7;&#x53D6;&#x81EA;&#x5DF1;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x9996;&#x5148;&#x9700;&#x8981;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;</span><span style="font-family: Calibri;">VCard</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;&#x8BE5;&#x5BF9;&#x8C61;&#x6765;&#x52A0;&#x8F7D;&#x81EA;&#x5DF1;&#x7684;&#x4E2A;&#x4EBA;&#x4FE1;&#x606F;&#x3002;</span></p>
<p>VCard&#xA0;&#xA0;vCard&#xA0;=&#xA0;new&#xA0;VCard();</p>
<p>vCard.load(conn);</p>
<p>&#x901A;&#x8FC7;<span style="font-family: Calibri;">get</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x4ECE;</span><span style="font-family: Calibri;">VCard</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5BF9;&#x8C61;&#x4E2D;&#x83B7;&#x53D6;&#x81EA;&#x5DF1;&#x60F3;&#x8981;&#x7684;&#x4FE1;&#x606F;&#x3002;&#x5982;</span><span style="font-family: Calibri;">vCard.getNickName()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x83B7;&#x53D6;&#x81EA;&#x5DF1;&#x7684;&#x6635;&#x79F0;&#x3002;</span></p>
<p>&#xA0;</p>
<p>&#x5982;&#x679C;&#x60F3;&#x8BBE;&#x7F6E;&#x6216;&#x4FEE;&#x6539;&#x81EA;&#x5DF1;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x9700;&#x8981;&#x7528;<span style="font-family: Calibri;">VCard</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;</span><span style="font-family: Calibri;">set</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x65B9;&#x6CD5;&#x3002;&#x5982;</span><span style="font-family: Calibri;">vCard.setNickName(</span>&#x201C;2b&#x201D;).</p>
<p>&#x5728;&#x8BBE;&#x7F6E;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x9700;&#x8981;&#x5C06;<span style="font-family: Calibri;">vCard</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x6570;&#x636E;&#x4FDD;&#x5230;&#x670D;&#x52A1;&#x5668;&#x4E2D;&#xFF0C;&#x65B9;&#x6CD5;&#x662F;</span><span style="font-family: Calibri;">vCard.save(conn)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x3002;</span></p>
<p>&#xA0;</p>
<p>&#x4E0A;&#x4F20;&#x5934;&#x50CF;&#x9700;&#x8981;&#x5411;&#x5BF9;&#x56FE;&#x7247;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x5C06;&#x5176;&#x8F6C;&#x5316;&#x4E3A;<span style="font-family: Calibri;">byte[]</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6570;&#x7EC4;&#x3002;&#x5047;&#x8BBE;&#x56FE;&#x7247;&#x6587;&#x4EF6;&#x5DF2;&#x88AB;&#x8F6C;&#x5316;&#x6210;</span><span style="font-family: Calibri;">bytes</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6570;&#x7EC4;&#x3002;&#x5728;&#x5C06;&#x56FE;&#x7247;&#x7528;</span><span style="font-family: Calibri;">set</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x65B9;&#x6CD5;&#x4FDD;&#x5B58;&#x524D;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x7F16;&#x7801;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4E0B;&#xFF1A;</span></p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x8C03;&#x7528;</span><span style="font-family: Calibri;">smack</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x63A5;&#x53E3;&#x5BF9;</span><span style="font-family: Calibri;">bytes</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7F16;&#x7801;</span></p>
<p>&#xA0;String&#xA0;encodedImage&#xA0;=&#xA0;StringUtils.encodeBase64(bytes);</p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x8BBE;&#x7F6E;</span></p>
<p>&#xA0;card.setAvatar(bytes,&#xA0;encodedImage);</p>
<p>//<span style="font-family: &#x5B8B;&#x4F53;;">&#x4FDD;&#x5B58;</span></p>
<p>card.save(conn);</p>
<p>&#xA0;</p>
<h2>5.2<span style="font-family: &#x5B8B;&#x4F53;;">&#x8D26;&#x6237;&#x4FE1;&#x606F;</span></h2>
<p>&#x8D26;&#x6237;&#x4FE1;&#x606F;&#x662F;&#x7531;<span style="font-family: Calibri;">AccountManager</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x7BA1;&#x7406;&#x3002;&#x5B83;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x7528;&#x6237;&#xFF0C;&#x4FEE;&#x6539;&#x5BC6;&#x7801;&#xFF0C;&#x83B7;&#x53D6;&#x7528;&#x6237;&#x4FE1;&#x606F;&#x7B49;&#x3002;</span></p>
<p>&#x9996;&#x5148;&#x6839;&#x636E;&#x8FDE;&#x63A5;&#x6765;&#x521B;&#x5EFA;<span style="font-family: Calibri;">AccountManager</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5BF9;&#x8C61;&#xFF0C;&#x518D;&#x8C03;&#x7528;&#x5B83;&#x7684;</span><span style="font-family: Calibri;">changePassword(String&#xA0;&#xA0;password)</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x65B9;&#x6CD5;&#x5373;&#x5B8C;&#x6210;&#x5BC6;&#x7801;&#x4FEE;&#x6539;</span><span style="font-family: Calibri;">.</span></p>
<p>AccountManager&#xA0;accountmanager&#xA0;=&#xA0;new&#xA0;Accountmanager(conn);</p>
<p>accountmanager.changePassword(&#x201C;new&#xA0;password&#x201D;);</p>
<p>&#xA0;</p>
<h1>6.<span style="font-family: &#x5B8B;&#x4F53;;">&#x4E0E;&#x5176;&#x4ED6;</span><span style="font-family: Calibri;">IM</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7ED1;&#x5B9A;</span></h1>
<p>&#xA0;&#xA0;&#xA0;&#xA0;Smcak<span style="font-family: &#x5B8B;&#x4F53;;">&#x662F;&#x57FA;&#x4E8E;</span><span style="font-family: Calibri;">XMPP</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x901A;&#x4FE1;&#x534F;&#x8BAE;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x652F;&#x6301;&#x4E0E;&#x5176;&#x4ED6;&#x57FA;&#x4E8E;</span><span style="font-family: Calibri;">XMPP</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;</span><span style="font-family: Calibri;">IM</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8F6F;&#x4EF6;&#x4E92;&#x901A;&#x3002;</span></p>
<h2>6.1<span style="font-family: &#x5B8B;&#x4F53;;">&#x5728;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x5B89;&#x88C5;&#x63D2;&#x4EF6;</span></h2>
<p>&#xA0;&#xA0;&#xA0;&#xA0;&#x4ECE;&#x7F51;&#x4E0A;&#x4E0B;&#x8F7D;<span style="font-family: Calibri;">gateway</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x63D2;&#x4EF6;&#xFF0C;&#x63A8;&#x8350;&#x4F7F;&#x7528;</span>Kraken&#xA0;IM&#xA0;Gateway&#xA0;&#xA0;&#xFF0C;&#x5C06;Kraken&#xA0;IM&#xA0;Gateway&#xA0;&#xA0;&#x5355;&#x72EC;<span style="font-family: Calibri;">jar</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5305;&#x62F7;&#x8D1D;&#x5230;</span><span style="font-family: Calibri;">openfire</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;</span><span style="font-family: Calibri;">plugin</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x91CD;&#x542F;</span><span style="font-family: Calibri;">openfire</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x5373;&#x53EF;&#xFF1B;&#x8BB0;&#x4F4F;&#xFF0C;&#x8FD9;&#x6837;&#x4F1A;&#x5BFC;&#x81F4;&#x670D;&#x52A1;&#x6682;&#x65F6;&#x7EC8;&#x6B62;&#x3002;</span></p>
<h2>6.2&#xA0;<span style="font-family: &#x5B8B;&#x4F53;;">&#x5728;&#x5BA2;&#x6237;&#x7AEF;&#x83B7;&#x53D6;&#x652F;&#x6301;&#x7ED1;&#x5B9A;&#x7684;</span><span style="font-family: Cambria;">IM</span></h2>
<p>&#x9996;&#x5148;&#x901A;&#x8FC7;ServiceDiscoveryManager&#x6765;&#x67E5;&#x8BE2;&#x5F53;&#x524D;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x7684;&#x63D0;&#x4F9B;&#x670D;&#x52A1;&#x4E3B;&#x4F53;&#x3002;&#x521B;&#x5EFA;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>ServiceDiscoveryManager&#xA0;sdm&#xA0;=&#xA0;ServiceDiscoveryManager.getInstanceFor(conn);</p>
<p>&#x518D;&#x901A;&#x8FC7;<span style="font-family: Calibri;">sdm</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8C03;&#x7528;</span>discoverItems(entityID)&#xFF0C;&#x5176;&#x4E2D;<span style="font-family: Calibri;">entityID</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x4EE3;&#x8868;</span>a&#xA0;given&#xA0;XMPP&#xA0;entity&#xA0;addressed&#xA0;by&#xA0;its&#xA0;JID&#xFF0C;&#x672C;&#x4F8B;&#x4E2D;&#x4E3A;&#x201C;<span style="font-family: Calibri;">z00189374</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x201D;&#xFF0C;&#x6765;&#x83B7;&#x53D6;&#x5305;&#x542B;&#x6240;&#x6709;</span><span style="font-family: Calibri;">items</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;</span>DiscoveryItems&#x5BF9;&#x8C61;&#xA0;&#x3002;&#x4EE3;&#x7801;&#x4E3A;&#xFF1A;</p>
<p>DiscoveryItems&#xA0;&#xA0;discoveryItems&#xA0;&#xA0;=&#xA0;&#xA0;sdm.discoveryItems(&#x201C;z00189374&#x201D;);</p>
<p>&#x518D;&#x901A;&#x8FC7;<span style="font-family: Calibri;">discoveryItems.getItems()</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x6765;&#x83B7;&#x53D6;&#x5173;&#x4E8E;&#x6240;&#x6709;</span><span style="font-family: Calibri;">Items&#xA0;</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7684;&#x8FED;&#x4EE3;&#x5668;&#x3002;</span></p>
<p>Iterator&lt;DiscoverItems.Item&gt;&#xA0;i&#xA0;=&#xA0;di.getItems();</p>
<p>&#x5728;&#x5BF9;&#x6BCF;&#x4E2A;<span style="font-family: Calibri;">Item</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x8FDB;&#x884C;&#x5224;&#x65AD;&#xFF0C;&#x89C2;&#x5BDF;&#x662F;&#x5426;&#x662F;&#x4E00;&#x79CD;</span><span style="font-family: Calibri;">IM</span><span style="font-family: &#x5B8B;&#x4F53;;">&#x7ED1;&#x5B9A;&#x652F;&#x6301;&#x3002;</span></p>
<p>String&#xA0;entityName&#xA0;=&#xA0;item.getEntityID();</p>
<p>if&#xA0;(entityName.startsWith(&quot;msn.&quot;))&#xA0;</p>
<p>&#xA0;</p>